<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>The Digital Cat - A Rust to-do list CLI app - Part 1</title>
    <meta charset="utf-8" />
    <meta http-equiv='content-language' content='en-gb'>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="description" content="A blog featuring in-depth posts about Python, Scala, TDD, devops, security and all things development">
<meta name="description" content="Nothing yet">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@thedigicat" />
<meta name="twitter:title" content="A Rust to-do list CLI app - Part 1" />
<meta name="twitter:description" content="Nothing yet" />
<meta name="twitter:image" content="https://www.thedigitalcatonline.com/images/a-rust-to-do-list-cli-app-part-1.jpg" />
    <script src="https://kit.fontawesome.com/15214b60ba.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,600;1,400;1,600&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="/theme/css/main.min.css?f6765de3">
    <link href="/images/global/favicon.jpg" rel="icon">
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74364524-1"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     
     gtag('config', 'UA-74364524-1');
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FZ55XG1KGG"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     
     gtag('config', 'G-FZ55XG1KGG');
    </script>
  </head>

  <body class="preload">
    <div class="container">
      <div class="sidebar navigation">
<nav>
<div class="links">
  <ul>
    <li class="link"><a href="/index.html">Homepage</a></li>
    <li class="link"><a href="/pages/about.html">About</a></li>
    <li class="link"><a href="/archives/index.html">Archives</a></li>
  </ul>
</div></nav>
<section>
  <header>
    <h2>Tags</h2>
  </header>
<ul class="tags">
    <li class="tag tag-size-3">
      <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Amiga" href="/categories/amiga/">Amiga</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Assembly" href="/categories/assembly/">Assembly</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about big data" href="/categories/big-data/">big data</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about blogging" href="/categories/blogging/">blogging</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about design" href="/categories/design/">design</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about devops" href="/categories/devops/">devops</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about distributed systems" href="/categories/distributed-systems/">distributed systems</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about ed25519" href="/categories/ed25519/">ed25519</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about editor" href="/categories/editor/">editor</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Emacs" href="/categories/emacs/">Emacs</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about HTML" href="/categories/html/">HTML</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about JavaScript" href="/categories/javascript/">JavaScript</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Lambda" href="/categories/lambda/">Lambda</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Markdown" href="/categories/markdown/">Markdown</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Mau" href="/categories/mau/">Mau</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about networking" href="/categories/networking/">networking</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pelican" href="/categories/pelican/">Pelican</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about pytest" href="/categories/pytest/">pytest</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Rust" href="/categories/rust/">Rust</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about software architecture" href="/categories/software-architecture/">software architecture</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Terraform" href="/categories/terraform/">Terraform</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about tools" href="/categories/tools/">tools</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul></section>
<section>
  <header>
    <h2>Categories</h2>
  </header>
<ul>
  <li><a href="/category/programming/">Programming</a></li>
  <li><a href="/category/projects/">Projects</a></li>
  <li><a href="/category/retro/">Retro</a></li>
</ul></section>
<section>
  <header>
    <h2>Feeds</h2>
  </header>
<ul>
  <li><i class="fas fa-rss" aria-hidden="true"></i> <a href="/atom.xml">All posts</a></li>


  <li><i class="fas fa-rss" aria-hidden="true"></i> <a href="/category/programming/atom.xml">All posts in category: Programming</a></li>
</ul></section>
<section>
  <header>
    <h2>Get in touch</h2>
  </header>
  <ul class="contact">
    <li><i class="fab fa-twitter" aria-hidden="true"></i> <a href="https://twitter.com/thedigicat">Twitter</a></li>
    <li><i class="fab fa-github" aria-hidden="true"></i> <a href="https://github.com/TheDigitalCatOnline">GitHub</a></li>
  </ul>
</section>      </div>
      <div class="page">
	<header class="primary" >
	  <button type="button">
	    <i class="fas fa-bars"></i>
	  </button>
	  <p>The Digital Cat</p>
	</header>
	<div class="mobile-menu navigation">
<nav>
<div class="links">
  <ul>
    <li class="link"><a href="/index.html">Homepage</a></li>
    <li class="link"><a href="/pages/about.html">About</a></li>
    <li class="link"><a href="/archives/index.html">Archives</a></li>
  </ul>
</div></nav>
<section>
  <header>
    <h2>Categories</h2>
  </header>
<ul>
  <li><a href="/category/programming/">Programming</a></li>
  <li><a href="/category/projects/">Projects</a></li>
  <li><a href="/category/retro/">Retro</a></li>
</ul></section>
<section>
  <header>
    <h2>Tags</h2>
  </header>
<ul class="tags">
    <li class="tag tag-size-3">
      <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Amiga" href="/categories/amiga/">Amiga</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Assembly" href="/categories/assembly/">Assembly</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about big data" href="/categories/big-data/">big data</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about blogging" href="/categories/blogging/">blogging</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about design" href="/categories/design/">design</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about devops" href="/categories/devops/">devops</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about distributed systems" href="/categories/distributed-systems/">distributed systems</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about ed25519" href="/categories/ed25519/">ed25519</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about editor" href="/categories/editor/">editor</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Emacs" href="/categories/emacs/">Emacs</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about HTML" href="/categories/html/">HTML</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about JavaScript" href="/categories/javascript/">JavaScript</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Lambda" href="/categories/lambda/">Lambda</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Markdown" href="/categories/markdown/">Markdown</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Mau" href="/categories/mau/">Mau</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about networking" href="/categories/networking/">networking</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pelican" href="/categories/pelican/">Pelican</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about pytest" href="/categories/pytest/">pytest</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Rust" href="/categories/rust/">Rust</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about software architecture" href="/categories/software-architecture/">software architecture</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Terraform" href="/categories/terraform/">Terraform</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about tools" href="/categories/tools/">tools</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul></section>	</div>
	
<div class="page-content">
  <header>
    <h1>A Rust to-do list CLI app - Part 1</h1>
    <div class="post-info">
      <p>By Leonardo Giordani - <i class="fas fa-calendar-alt"></i> <time datetime="2024-02-14T18:00:00+01:00"> 14/02/2024</time></p>
      <p class="tags">
	<a class="tag category" href="/category/programming/" title="All posts in category Programming">Programming</a>
	<a class="tag" href="/categories/rust/">Rust</a>
	<a class="tag" href="/categories/tdd/">TDD</a>
      </p>
      <p class="share">Share on: <span><a class="" href="https://twitter.com/intent/tweet?text=A%20Rust%20to-do%20list%20CLI%20app%20-%20Part%201&url=https%3A//www.thedigitalcatonline.com/blog/2024/02/14/a-rust-to-do-list-cli-app-part-1/&via=thedigicat&hashtags=rust,tdd" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i> Twitter</a></span>
<span><a class="" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//www.thedigitalcatonline.com/blog/2024/02/14/a-rust-to-do-list-cli-app-part-1/&title=A%20Rust%20to-do%20list%20CLI%20app%20-%20Part%201&summary=Nothing%20yet&source=https%3A//www.thedigitalcatonline.com/blog/2024/02/14/a-rust-to-do-list-cli-app-part-1/" target="_blank" title="Share on LinkedIn"><i class="fab fa-linkedin"></i> LinkedIn</a></span>
<span><a class="" href="https://news.ycombinator.com/submitlink?t=A%20Rust%20to-do%20list%20CLI%20app%20-%20Part%201&u=https%3A//www.thedigitalcatonline.com/blog/2024/02/14/a-rust-to-do-list-cli-app-part-1/" target="_blank" title="Share on HackerNews"><i class="fab fa-hacker-news"></i> HackerNews</a></span>
<span><a class="" href="mailto:?subject=A%20Rust%20to-do%20list%20CLI%20app%20-%20Part%201&amp;body=https%3A//www.thedigitalcatonline.com/blog/2024/02/14/a-rust-to-do-list-cli-app-part-1/" target="_blank" title="Share via Email"><i class="fas fa-envelope"></i> Email</a></span>
<span><a class="" href="https://www.reddit.com/submit?url=https%3A//www.thedigitalcatonline.com/blog/2024/02/14/a-rust-to-do-list-cli-app-part-1/&title=A%20Rust%20to-do%20list%20CLI%20app%20-%20Part%201" target="_blank" title="Share via Reddit"><i class="fab fa-reddit"></i> Reddit</a></span></p>    
    </div>
  </header>
  
  <div class="post-content">
    <p>This blog was born as a place where I could share what I discovered while I was learning new technologies and concepts. Remaining faithful to this manifesto, I decided to start writing some posts about Rust, as I recently joined the vibrant community behind this language. My roots are in C and Assembly, so I feel at home with Rust that looks to me like a proper modern version of C. As such, I&#x27;m supremely interested in the ideas behind it, and in particular I want to focus on low-level data representation, structures, and memory usage.</p><p>After having read the manual and implemented several snippets, I decided to try to implement a more complete application and to annotate the journey here. While I was looking for a tutorial I found <a href="https://www.freecodecamp.org/news/how-to-build-a-to-do-app-with-rust/">this useful post</a> by Claudio Restifo, where he develops a simple to-do list management application.</p><p>So, I decided to implement the same using Claudio&#x27;s solution when I was stuck or to compare his strategy with mine, as it is always extremely useful to see how another coder tackles certain challenges. Thanks Claudio! However, as I&#x27;m a big fan of TDD, I&#x27;d like to follow that approach, which is something that Claudio doesn&#x27;t do in his post.</p><p>Please keep in mind that these are my first steps with the language, so consider what you read here as the work of a beginner (as I am, with this language). I&#x27;m more than happy to receive advice or corrections, so feel free to get in touch if you see anything that can be done in a better way. In the post, you will find annotations that highlight the major topics that I think a Rust programmer should be familiar with.</p><h2 id="requirements-dd57">Requirements<a class="headerlink" href="#requirements-dd57" title="Permanent link">¶</a></h2><p>The requirements I set for the application are:</p><ul><li>Manage a list of entries. Each entry can be in state &quot;to be done&quot; or &quot;done&quot;.</li><li>Provide commands to view, add, delete and mark items as &quot;done&quot; or &quot;to be done&quot;.</li><li>Can save and retrieve data from a file. The file has a default name that can be changed with an option.</li></ul><p>This is an extremely basic application, so the command line is: <code>todo [OPTIONS] COMMAND [KEY]</code>.</p><p>I expect the interaction with the tool to be something like</p><div class="code"><div class="content"><div class="highlight"><pre>$ todo list
# TO DO

* Write post
* Buy milk
* Have fun

# DONE

* Feed the cat

$ todo add &quot;Update CV&quot;
$ todo mark-done &quot;Buy milk&quot;
$ todo list
# TO DO

* Write post
* Have fun
* Update CV

# DONE

* Feed the cat
* Buy milk
</pre></div></div></div><h2 id="initial-setup-7d57">Initial setup<a class="headerlink" href="#initial-setup-7d57" title="Permanent link">¶</a></h2><p>Starting a new Rust project is extremely simple with Cargo:</p><div class="code"><div class="content"><div class="highlight"><pre><span class="cp">$</span><span class="w"> </span><span class="n">cargo</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">todo</span><span class="o">-</span><span class="n">cli</span>
</pre></div></div></div><p>This will create the required structure in a new directory and create two files: <code>Cargo.toml</code> and <code>src/main.rs</code>. The latter will contain some placeholder code that we can use to check our setup</p><div class="code"><div class="title"><code>main.rs</code></div><div class="content"><div class="highlight"><pre><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div></div></div><p>We can run the code with <code>cargo run</code> or build it into a stand-alone executable with <code>cargo build</code>. This will compile the code in debug mode by default and put the executable in the directory <code>target/debug</code>. Cargo can be used to run tests as well (<code>cargo test</code>).</p><div class="infobox"><div class="title">Cargo</div><div><p>Cargo [<a href="https://doc.rust-lang.org/cargo">docs</a>] is the Rust package manager and the default solution to manage dependencies, compile packages and in general to manage your code. It&#x27;s highly recommended to learn at least the basics of this powerful tool.</p></div></div><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/a7c4616179fdcce0b5bc6010402c1d914ac1587b">See the source code</a></div></div></div><h2 id="cli-management-3bb6">CLI management<a class="headerlink" href="#cli-management-3bb6" title="Permanent link">¶</a></h2><p>Command line interfaces are typically not part of the classic TDD cycle, as they should be part of integration tests. Now, the definition that the Rust community uses for <em>integration tests</em> is</p><blockquote><p>Integration tests are external to your crate and use only its public interface in the same way any other code would. Their purpose is to test that many parts of your library work correctly together.</p><cite></cite></blockquote><p>So, the <em>integration</em> they consider here is that between multiple parts of a library. What I am referring to here is more properly <em>system integration tests</em>, where we test the public interface of a whole tool. Long story short, I will not write tests for the CLI commands.</p><p>In the aforementioned post, Claudio Restifo suggests we can read command line arguments using <code>std::env::args()</code> directly with something like</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">env</span><span class="p">::</span><span class="n">args</span><span class="p">().</span><span class="n">nth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Please specify an action&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">env</span><span class="p">::</span><span class="n">args</span><span class="p">().</span><span class="n">nth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Please specify an item&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{:?}, {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">);</span>
<span class="p">}</span>
</pre></div></div></div><div class="infobox"><div class="title">Modules</div><div><p>In Rust a module can be used directly as long as it is part of the current project. The standard library is clearly visible by default, while other modules have to be declared in the file <code>Cargo.toml</code>. It is then perfectly acceptable to write <code>let action = std::env::args()...</code>.</p>
<p><a href="https://doc.rust-lang.org/reference/items/use-declarations.html">Use declarations</a>, however, can import other modules into the current namespace, to make the code more readable.</p></div></div><p>The method <code>nth</code> [<a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#method.nth">docs</a>] returns (not too surprisingly) the nth element of an iterator.</p><div class="infobox"><div class="title">Iterators</div><div><p>The Rust documentation contains a very useful section on iterators [<a href="https://doc.rust-lang.org//std/iter/index.html">docs</a>].</p>
<p>The function <code>std::env::args</code> [<a href="https://doc.rust-lang.org//std/env/fn.args.html">docs</a>] (used to access the command line arguments in the traditional Unix fashion) returns <code>Args</code> [<a href="https://doc.rust-lang.org//std/env/struct.Args.html">docs</a>], which implements the trait <code>Iterator</code>.</p>
<p>As it happens in object-oriented programming languages (which Rust is not), the expression &quot;implements an interface&quot; is often simplified to &quot;is&quot;. So, colloquially speaking, we can say that <code>std::env::Args</code> is an <code>Iterator</code> [<a href="https://doc.rust-lang.org//std/iter/trait.Iterator.html">docs</a>].</p></div></div><p>The prototype of <code>nth</code> is</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">fn</span><span class="w"> </span><span class="nf">nth</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="bp">Self</span><span class="p">::</span><span class="n">Item</span><span class="o">&gt;</span>
</pre></div></div></div><p>and it mentions <code>Option&lt;Self::Item&gt;</code> as the return type. The type <code>Option</code> provides a method <code>expect</code> [<a href="https://doc.rust-lang.org//std/option/enum.Option.html#method.expect">docs</a>] that returns either the content of the <code>Some</code> value or panics, printing the given message in the backtrace.</p><div class="infobox"><div class="title">Option</div><div><p><code>Option</code> [<a href="https://doc.rust-lang.org/std/option/index.html">docs</a>] and <code>Result</code> [<a href="https://doc.rust-lang.org/std/result/index.html">docs</a>] are a versatile way to manage optional results (either something or nothing) and results (either something good or an error), and are among the most important structures to learn in Rust.</p></div></div><p>Running the code above with <code>cargo run</code> produces the following output, where we can see the message set by the first call to <code>expect</code>.</p><div class="code"><div class="content"><div class="highlight"><pre>    Finished dev [unoptimized + debuginfo] target(s) in 0.01s
     Running `target/debug/todo-cli`
thread &#39;main&#39; panicked at src/main.rs:80:42:
<span class="hll">Please specify an action
</span>note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</pre></div></div></div><h2 id="better-cli-management-with-clap-74e2">Better CLI management with Clap<a class="headerlink" href="#better-cli-management-with-clap-74e2" title="Permanent link">¶</a></h2><p><a href="https://docs.rs/clap/latest/clap/">Clap</a> stands for <strong>C</strong>ommand <strong>L</strong>ine <strong>A</strong>rgument <strong>P</strong>arser and is a nice crate that simplifies the creation of advanced command line interfaces. I installed it using</p><div class="code"><div class="content"><div class="highlight"><pre>$ cargo add clap --features derive
</pre></div></div></div><p>as detailed in the documentation and my code is now</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">use</span><span class="w"> </span><span class="n">clap</span><span class="p">::</span><span class="n">Parser</span><span class="p">;</span>

<span class="cp">#[derive(Parser)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Cli</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">command</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cli</span><span class="p">::</span><span class="n">parse</span><span class="p">();</span>

<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Command line: {} {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">key</span><span class="p">);</span>
<span class="p">}</span>
</pre></div></div></div><p>Clap allows me to add long and short options as well, so later I will use it to specify the database file name. For now, however, this is enough.</p><div class="infobox"><div class="title">derive</div><div><p>The attribute <code>derive</code> [<a href="https://doc.rust-lang.org/reference/attributes/derive.html">docs</a>] is another cornerstone of the language and is used everywhere. The machinery behind it is not trivial, but I recommend getting used to the syntax and the standard use cases.</p></div></div><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/b85162745b90e96a58ee58a5a7306e599aa56fa1">See the source code</a></div></div></div><h2 id="a-simple-list-of-elements-2dfb">A simple list of elements<a class="headerlink" href="#a-simple-list-of-elements-2dfb" title="Permanent link">¶</a></h2><p>From Claudio&#x27;s post I got the idea of using a hash map for the list of items. That&#x27;s a simple and effective solution, in particular given the fact that Rust provides the collection type out of the box.</p><p>As I want to use TDD, I begin with a test. In Rust, we put tests and code in the same file (but for integration tests between modules), so I can write a simple test at the bottom of the file to check that a <code>TodoList</code> type exists and can be initialised.</p><div class="code"><div class="content"><div class="highlight"><pre><span class="cp">#[cfg(test)]</span>
<span class="k">mod</span><span class="w"> </span><span class="nn">tests</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>

<span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">init_todo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><div class="infobox"><div class="title">TDD</div><div><p>TDD is one of my favourite methodologies and I&#x27;m happy to see that Rust allows me to follow it. I can&#x27;t recommend TDD enough! The Rust book contains <a href="https://doc.rust-lang.org/book/ch11-01-writing-tests.html">a pretty detailed chapter</a> on how to write tests.</p></div></div><p>Clearly, when I run <code>cargo test</code> I get a compile error. Let&#x27;s implement the type then</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">use</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">collections</span><span class="p">::</span><span class="n">HashMap</span><span class="p">;</span>

<span class="p">[</span><span class="o">..</span><span class="p">.]</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">TodoList</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// true = to do, false = done</span>
<span class="w">    </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div></div></div><p>As you see, I had to write a comment as a reminder of the meaning of the boolean values. I also suspect that I will need to use the type <code>HashMap&lt;String, bool&gt;</code> multiple times, so I will probably end up creating a type alias of some sort.</p><p>To initialise such structure I have to create an implementation of the function <code>new</code></p><div class="code"><div class="title">Version 1</div><div class="content"><div class="highlight"><pre><span class="k">impl</span><span class="w"> </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">new</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">TodoList</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="n">HashMap</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>

<span class="w">        </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">items</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><div class="infobox"><div class="title">struct and impl</div><div><p>Rust is not an object-oriented programming language, so it uses plain structs to encapsulate data. The Rust book has <a href="https://doc.rust-lang.org/book/ch05-01-defining-structs.html">a full chapter</a> on <code>struct</code> and <code>impl</code>.</p></div></div><p>Thanks to type inference, the explicit definition of types after the call to <code>HashMap</code> is not needed and I can write</p><div class="code"><div class="title">Version 2</div><div class="content"><div class="highlight"><pre><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HashMap</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
</pre></div></div></div><p>or</p><div class="code"><div class="title">Version 3</div><div class="content"><div class="highlight"><pre><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HashMap</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
</pre></div></div></div><p>For such a simple initialisation, I might also write directly</p><div class="code"><div class="title">Version 4</div><div class="content"><div class="highlight"><pre><span class="w">        </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">::</span><span class="n">new</span><span class="p">(),</span>
<span class="w">        </span><span class="p">}</span>
</pre></div></div></div><p>However, I will soon replace the <code>::new()</code> with something more complicated that reads a file, so I decided to keep version 2. This code passes the test I wrote, so it&#x27;s good enough for now.</p><p>At this point I can also initialise the list in the main function</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">struct</span><span class="w"> </span><span class="nc">TodoList</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// true = to do, false = done</span>
<span class="w">    </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span><span class="w"> </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">new</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">TodoList</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HashMap</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>

<span class="w">        </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nc">items</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cli</span><span class="p">::</span><span class="n">parse</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>

<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;Command line: {} {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">key</span><span class="p">);</span>
<span class="p">}</span>
</pre></div></div></div><p>Please note that I&#x27;m not being too strict with dead code here and the compile will complain about unused variables and fields. I like this, and I won&#x27;t add underscores to silence the warnings since they are a good reminder of what I still have to implement.</p><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/0e49a12d38b1c3a5de9332507608b2c0c3f17ad8">See the source code</a></div></div></div><h2 id="adding-items-ea14">Adding items<a class="headerlink" href="#adding-items-ea14" title="Permanent link">¶</a></h2><p>A good improvement at this point would be to create a method to add items to the list. First, the mandatory test</p><div class="code"><div class="content"><div class="highlight"><pre><span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">add_item</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="o">&amp;</span><span class="kc">true</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>The type <code>HashMap</code> provides a method called <code>insert</code> [<a href="https://doc.rust-lang.org/std/collections/struct.HashMap.html#method.insert">docs</a>] which is exactly what I need</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">impl</span><span class="w"> </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="o">..</span><span class="p">.</span>

<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><p>And once again this code passes the test, so I consider it good enough.</p><div class="infobox"><div class="title">self and Self</div><div><p>In Rust <code>self</code> is a keyword [<a href="https://doc.rust-lang.org/std/keyword.self.html">docs</a>] and not just a name as it happens in Python. Rust considers <code>self</code> of type <code>Self</code> [<a href="https://doc.rust-lang.org/std/keyword.SelfTy.html">docs</a>], which is the type we are implementing in a <code>trait</code> or <code>impl</code> block.</p>
<p>The code <code>fn add(&amp;mut self, key: String) {</code> above is equivalent to <code>fn add(self: &amp;mut Self, key: String) {</code>. However, <code>self</code> cannot be renamed to something like <code>foo</code>, as Rust is expecting a parameter with that specific name.</p></div></div><div class="infobox"><div class="title">References and mutability</div><div><p>I found confusing, at first, that in Rust we usually call <code>&amp;mut</code> a <em>mutable reference</em>. In my head, I always translate it into a <em>reference to mutable data</em> as this helps me to remember what I am doing here.</p>
<p>In short, in Rust we need to declare explicitly when we intend to consider a value mutable using the keyword <code>mut</code> [<a href="https://doc.rust-lang.org/std/keyword.mut.html">docs</a>], and this is valid also when we pass arguments to functions. If we decide to borrow data instead of moving it, we can use <em>references</em>, that in C terms are equivalent to protected pointers. We can also pass a reference to data that we intend to mutate, which is where <code>&amp;mut</code> comes into play.</p>
<p>However, as I mentioned I think it&#x27;s important to understand that the reference (a pointer) is not mutating. The data referenced by it is.</p></div></div><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/320c31afba90c63e0482e4442d580d7de1fcfbd4">See the source code</a></div></div></div><h2 id="multiple-additions-and-updates-a15c">Multiple additions and updates<a class="headerlink" href="#multiple-additions-and-updates-a15c" title="Permanent link">¶</a></h2><p>If I add the same key multiple times I want the list to contain only one occurrence, so I test this.</p><div class="code"><div class="content"><div class="highlight"><pre><span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">add_item_already_exist</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="o">&amp;</span><span class="kc">true</span><span class="p">));</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">len</span><span class="p">(),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>The test passes already, thanks to the properties of the hash map.</p><p>I also want the second insertion not to update the value of the existing element, and in this case the test is</p><div class="code"><div class="content"><div class="highlight"><pre><span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">add_item_does_not_change_value</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="o">&amp;</span><span class="kc">false</span><span class="p">));</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">len</span><span class="p">(),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>I have to manually change the value inside the map using <code>get_mut</code> [<a href="https://doc.rust-lang.org/std/collections/struct.HashMap.html#method.get_mut">docs</a>] that returns a mutable reference to the value. This test doesn&#x27;t pass, as <code>insert</code> actually updates the existing value.</p><p>At the time of writing the method <code>try_insert</code> of <code>HashMap</code> is experimental, so I implemented a custom solution</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">use</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">collections</span><span class="p">::</span><span class="n">hash_map</span><span class="p">::</span><span class="n">Entry</span><span class="p">;</span>

<span class="p">[</span><span class="o">..</span><span class="p">.]</span>


<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">Entry</span><span class="p">::</span><span class="n">Vacant</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">entry</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">entry</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>Here, I&#x27;m basically checking if an entry for <code>key</code> is vacant (does not exist) and I create it only in that case. This code passes all tests.</p><div class="infobox"><div class="title">if let</div><div><p>I consider <code>if let</code> [<a href="https://doc.rust-lang.org/book/ch06-03-if-let.html">docs</a>] a very powerful piece of syntax. I care only about one of the possible outcomes, so I don&#x27;t want to waste time defining it in a full-fledged <code>match</code>.</p></div></div><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/e0ee0b9fdb14e2d7f4d0a5022718d5c7923249e6">See the source code</a></div></div></div><h2 id="marking-items-9ca3">Marking items<a class="headerlink" href="#marking-items-9ca3" title="Permanent link">¶</a></h2><p>The second method I want to add is <code>mark</code> that allows me to set the value of the boolean corresponding to a given key. This will be used to flag an item as &quot;done&quot; or &quot;to be done&quot;. The test is</p><div class="code"><div class="content"><div class="highlight"><pre><span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">mark_item</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="o">&amp;</span><span class="kc">false</span><span class="p">))</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="o">&amp;</span><span class="kc">true</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>Here, I can follow the same strategy I used in the test <code>add_item_does_not_change_value</code></p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">impl</span><span class="w"> </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="o">..</span><span class="p">.</span>

<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">mark</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="o">&amp;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><p>What if the key is not in the list, though? The function <code>get_mut</code> returns an Option, but <code>mark</code> should signal with a <code>Result</code> that something didn&#x27;t work. I can test this with</p><div class="code"><div class="content"><div class="highlight"><pre><span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">mark_item_does_not_exist</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span>
<span class="w">            </span><span class="n">todo</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">),</span>
<span class="w">            </span><span class="nb">Err</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>The new version of the function is then</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">impl</span><span class="w"> </span><span class="n">TodoList</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="o">..</span><span class="p">.</span>

<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">mark</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="o">&amp;</span><span class="n">key</span><span class="p">).</span><span class="n">ok_or</span><span class="p">(</span><span class="o">&amp;</span><span class="n">key</span><span class="p">)</span><span class="o">?</span><span class="p">;</span>
<span class="w">        </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>

<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><p>The method <code>ok_or</code> [<a href="https://doc.rust-lang.org/std/option/enum.Option.html#method.ok_or">docs</a>] converts an <code>Option</code> into a <code>Result</code>, so I just call <code>?</code> to propagate the error.</p><div class="infobox"><div class="title">The question mark operator</div><div><p>The operator <code>?</code> is one of the best features of Rust, and it&#x27;s explained in <a href="https://doc.rust-lang.org/book/ch09-02-recoverable-errors-with-result.html">this chapter</a> of the Rust Book. I find it such a simple yet extremely powerful way to deal with error propagation.</p></div></div><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/15179a8821f73ea5479d7bde1060126158e5eb7e">See the source code</a></div></div></div><h2 id="listing-items-449d">Listing items<a class="headerlink" href="#listing-items-449d" title="Permanent link">¶</a></h2><p>At this point I want to add the method <code>list</code> that allows me to see the items contained in <code>TodoList</code>. I&#x27;d like to separate the logic from the presentation so the method will return two lists of items, one for each value of the connected boolean.</p><p>This means that the output of the method should in my opinion be a tuple of iterators, one on the items with state &quot;to be done&quot; and one on the ones in state &quot;done&quot;.</p><div class="infobox"><div class="title">Iterators</div><div><p>Iterators are a big thing in Rust, and I can understand why as they definitely boost performances saving memory. The Rust book has <a href="https://doc.rust-lang.org/book/ch13-02-iterators.html">a chapter</a> on them, and there is clearly plenty of documentation for the <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html">relative trait</a>.</p></div></div><p>I start with tests as usual</p><div class="code"><div class="content"><div class="highlight"><pre><span class="w">    </span><span class="cp">#[test]</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">list_items</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something else to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something done&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">todo</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something done&quot;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">todo_items</span><span class="p">,</span><span class="w"> </span><span class="n">done_items</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">list</span><span class="p">();</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">todo_items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo_items</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">collect</span><span class="p">();</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">done_items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">done_items</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">clone</span><span class="p">()).</span><span class="n">collect</span><span class="p">();</span>

<span class="w">        </span><span class="fm">assert!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">e</span><span class="o">|</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="fm">assert!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something else to do&quot;</span><span class="p">)));</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">len</span><span class="p">(),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">        </span><span class="fm">assert!</span><span class="p">(</span><span class="n">done_items</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something done&quot;</span><span class="p">)));</span>
<span class="w">        </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">done_items</span><span class="p">.</span><span class="n">len</span><span class="p">(),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>There is a lot to say here, and please remember the caveat that I&#x27;m not sure what I&#x27;m doing is the best thing.</p><p>I add some elements to the list and mark one as done, then I call the method <code>list</code> to get two iterators and test them. However, iterators can be traversed only once, so to test them properly I prefer to convert them into vectors using the method <code>collect</code> [<a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#method.collect">docs</a>].</p><p>To generate the two iterators I will probably use <code>HashMap::iter</code> [<a href="https://doc.rust-lang.org/std/collections/struct.HashMap.html#method.iter">docs</a>], which means they will have an element type <code>&amp;String</code>, as we are interested in the item key.</p><p>As far as I can tell, there are several different strategies I can use here.</p><p>I can generate vectors of <code>&amp;String</code> using the elements directly from the iterators and then use the method <code>Vec::contains</code> [<a href="https://doc.rust-lang.org/std/vec/struct.Vec.html#method.contains">docs</a>]. However, the latter wants to receive a reference to the searched value, which means that I would end up with</p><div class="code"><div class="content"><div class="highlight"><pre><span class="kd">let</span><span class="w"> </span><span class="n">todo_items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;&amp;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo_items</span><span class="p">.</span><span class="n">collect</span><span class="p">();</span>
<span class="fm">assert!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="o">&amp;&amp;</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something else to do&quot;</span><span class="p">)));</span>
</pre></div></div></div><p>While this is perfectly reasonable in terms of memory consumption and performances, the double <code>&amp;&amp;</code> is a bit ugly. So, considering that I&#x27;m writing a test, where performances are not the major concern, I&#x27;d prefer to simplify the syntax. I can create a vector of <code>String</code> values and check them</p><div class="code"><div class="content"><div class="highlight"><pre><span class="kd">let</span><span class="w"> </span><span class="n">todo_items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo_items</span><span class="p">.</span><span class="n">cloned</span><span class="p">().</span><span class="n">collect</span><span class="p">();</span>
<span class="fm">assert!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something else to do&quot;</span><span class="p">)));</span>
</pre></div></div></div><p>The syntax <code>todo_items.cloned()</code> is equivalent to <code>todo_items.map(|x| x.clone())</code> and leverages the implicit dereferencing of <code>x</code>. Here, <code>copied()</code> cannot be used as <code>String</code> doesn&#x27;t implement the trait <code>Copy</code>.</p><p>A good alternative to <code>contains</code> is <code>any</code>, which however works on iterators. A final version of the code is then</p><div class="code"><div class="content"><div class="highlight"><pre><span class="kd">let</span><span class="w"> </span><span class="n">todo_items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo_items</span><span class="p">.</span><span class="n">cloned</span><span class="p">().</span><span class="n">collect</span><span class="p">();</span>
<span class="fm">assert!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">e</span><span class="o">|</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
</pre></div></div></div><p>Which is also more elegant since it uses the comparison between a <code>String</code> (which is the iterator item type) and an <code>&amp;str</code> (the right side). At this point my test is</p><div class="code"><div class="content"><div class="highlight"><pre><span class="cp">#[test]</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">list_items</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something else to do&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something done&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="nb">String</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Something done&quot;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">todo_items</span><span class="p">,</span><span class="w"> </span><span class="n">done_items</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">list</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">todo_items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo_items</span><span class="p">.</span><span class="n">cloned</span><span class="p">().</span><span class="n">collect</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">done_items</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">done_items</span><span class="p">.</span><span class="n">cloned</span><span class="p">().</span><span class="n">collect</span><span class="p">();</span>

<span class="w">    </span><span class="fm">assert!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">e</span><span class="o">|</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Something to do&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="fm">assert!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">e</span><span class="o">|</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Something else to do&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">todo_items</span><span class="p">.</span><span class="n">len</span><span class="p">(),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="fm">assert!</span><span class="p">(</span><span class="n">done_items</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="o">|</span><span class="n">e</span><span class="o">|</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Something done&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">done_items</span><span class="p">.</span><span class="n">len</span><span class="p">(),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div></div></div><p>An implementation of the method <code>list</code> that passes this test is</p><div class="code"><div class="content"><div class="highlight"><pre><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span>
<span class="w">       </span><span class="p">(</span><span class="k">impl</span><span class="w"> </span><span class="nb">Iterator</span><span class="o">&lt;</span><span class="n">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="k">impl</span><span class="w"> </span><span class="nb">Iterator</span><span class="o">&lt;</span><span class="n">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">(</span>
<span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">filter</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">true</span><span class="p">).</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span>
<span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">filter</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">false</span><span class="p">).</span><span class="n">map</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
</pre></div></div></div><p>Here, the powerful keyword <code>impl</code> declares that whatever comes out of that function implements the <code>Iterator</code> trait with an element type <code>String</code>. The code uses <code>iter</code> [<a href="https://doc.rust-lang.org/std/collections/struct.HashMap.html#method.iter">docs</a>] to create an iterator on the elements of the hash map (element type <code>(&amp;String, &amp;bool)</code>, then uses <code>map</code> [<a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#method.map">docs</a>] to extract the first element of each tuple. All in all, the function returns a tuple of <code>Map</code> [<a href="https://doc.rust-lang.org/std/iter/struct.Map.html">docs</a>] which is a type that implements <code>Iterator</code>.</p><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/40293e0aab286505e67f3932c16c1367bf92560c">See the source code</a></div></div></div><h2 id="exposing-commands-on-the-cli-4eb5">Exposing commands on the CLI<a class="headerlink" href="#exposing-commands-on-the-cli-4eb5" title="Permanent link">¶</a></h2><p>It&#x27;s time to expose the methods I implemented on the CLI. I realised that commands like <code>add</code> and <code>mark-done</code> require a second argument (the key), other commands like <code>list</code> don&#x27;t.</p><p>So, the first change is to make the key argument optional.</p><div class="code"><div class="content"><div class="highlight"><pre><span class="cp">#[derive(Parser)]</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Cli</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">command</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span>

<span class="hll"><span class="w">    </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span>
</span><span class="p">}</span>
</pre></div></div></div><p>Purely to have something to play with, I will also add some values to the list in <code>main</code>. This is temporary, as long as I don&#x27;t implement a file storage mechanism.</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cli</span><span class="p">::</span><span class="n">parse</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">todo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TodoList</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>

<span class="hll"><span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;Something to do&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span>
</span><span class="hll"><span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;Something else to do&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span>
</span><span class="hll"><span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;Something done&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span>
</span><span class="hll"><span class="w">    </span><span class="n">todo</span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="s">&quot;Something done&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="kc">false</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span>
</span><span class="p">}</span>
</pre></div></div></div><p>Last, the command-method binding part. A match construct is the best option in this case, something like</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">match</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">command</span><span class="p">.</span><span class="n">as_str</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;add&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">..</span><span class="p">.,</span>
<span class="w">    </span><span class="s">&quot;mark-done&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">..</span><span class="p">.,</span>
<span class="w">    </span><span class="s">&quot;list&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">..</span><span class="p">.</span>
<span class="p">}</span>
</pre></div></div></div><div class="infobox"><div class="title">match</div><div><p>The <code>match</code> control flow construct is a blessing that comes directly from functional programming, where pattern matching is an important tool. The Rust book has <a href="https://doc.rust-lang.org/book/ch06-02-match.html#the-match-control-flow-construct">a chapter dedicated to it</a> and <a href="https://doc.rust-lang.org/book/ch18-03-pattern-syntax.html">a chapter on the pattern syntax</a>.</p></div></div><p>However, since each method has a different return type, I need the whole construct to return a uniform <code>Result</code> that can be used to print a meaningful state message at the end of the execution.</p><p>The code I wrote is the following</p><div class="code"><div class="content"><div class="highlight"><pre><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="o">..</span><span class="p">.</span>

<span class="w">   </span><span class="kd">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">command</span><span class="p">.</span><span class="n">as_str</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;add&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">todo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="w">                </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="nb">None</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&quot;Key cannot be empty!&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">()),</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="s">&quot;mark-done&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">todo</span>
<span class="w">                </span><span class="p">.</span><span class="n">mark</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">map_err</span><span class="p">(</span><span class="o">|</span><span class="n">e</span><span class="o">|</span><span class="w"> </span><span class="fm">format!</span><span class="p">(</span><span class="s">&quot;Invalid key {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="n">and</span><span class="p">(</span><span class="nb">Ok</span><span class="p">(())),</span>
<span class="w">            </span><span class="nb">None</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">&quot;Key cannot be empty!&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">()),</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="s">&quot;list&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">todo_items</span><span class="p">,</span><span class="w"> </span><span class="n">done_items</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">todo</span><span class="p">.</span><span class="n">list</span><span class="p">();</span>

<span class="w">            </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;# TO DO&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="fm">println!</span><span class="p">();</span>
<span class="w">            </span><span class="n">todo_items</span><span class="p">.</span><span class="n">for_each</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot; * {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">));</span>

<span class="w">            </span><span class="fm">println!</span><span class="p">();</span>

<span class="w">            </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;# DONE&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="fm">println!</span><span class="p">();</span>
<span class="w">            </span><span class="n">done_items</span><span class="p">.</span><span class="n">for_each</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot; * {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">));</span>

<span class="w">            </span><span class="nb">Ok</span><span class="p">(())</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">cmd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="fm">format!</span><span class="p">(</span><span class="s">&quot;Command {} not recognised&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cmd</span><span class="p">)),</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;ERROR: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">),</span>
<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;SUCCESS&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><div class="infobox"><div class="title">Option and Result</div><div><p>It&#x27;s paramount to learn how to convert <code>Option</code> [<a href="https://doc.rust-lang.org/std/option/enum.Option.html">docs</a>] into <code>Result</code> [<a href="https://doc.rust-lang.org/std/result/enum.Result.html">docs</a>] and vice versa, as well as how to convert a <code>Result</code> type into a different one. Being familiar with functions like <code>map_err</code> [<a href="https://doc.rust-lang.org/std/result/enum.Result.html#method.map_err">docs</a>] or <code>and</code> [<a href="https://doc.rust-lang.org/std/result/enum.Result.html#method.and">docs</a>] will drastically change the quality of your Rust code.</p></div></div><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/89cccf4d64c7c998b6f254d3af2f68557e58759b">See the source code</a></div></div></div><h2 id="tidy-up-99b9">Tidy up<a class="headerlink" href="#tidy-up-99b9" title="Permanent link">¶</a></h2><p>At this point I went through the code and fixed some of the warning the compiler was still giving me. These all come from the tests, where I created the <code>todo</code> variable but never used it, and where I ignored the results returned by calls of <code>todo.mark</code>. There, I used <code>unwrap</code> [<a href="https://doc.rust-lang.org/std/result/enum.Result.html#method.unwrap">docs</a>] as I&#x27;m happy for that to panic if something goes wrong.</p><div class="admonition"><i class="fa fa-github"></i><div class="content"><div><a href="https://github.com/lgiordani/rust-todo-cli/tree/39d406d483bc79fff262211beff473027cd02794">See the source code</a></div></div></div><h2 id="final-words-9803">Final words<a class="headerlink" href="#final-words-9803" title="Permanent link">¶</a></h2><p>What a journey so far! It&#x27;s really true that you can&#x27;t consider a language learned until you start from scratch and try to use it to implement a real application. Well, it&#x27;s not over yet, I&#x27;m still missing an important part which is the file storage.</p><p>If you have comments, suggestions, or corrections, please let me know! I am more than happy to learn something new from other coders and to publish updates to the post.</p><h2 id="feedback-d845">Feedback<a class="headerlink" href="#feedback-d845" title="Permanent link">¶</a></h2><p>Feel free to reach me on <a href="https://twitter.com/thedigicat">Twitter</a> if you have questions. The <a href="https://github.com/TheDigitalCatOnline/blog_source/issues">GitHub issues</a> page is the best place to submit corrections.</p>
  </div>


  <section>
    <header>
      <h2>Related Posts</h2>
    </header>
    <div class="paginated-posts">
      <div class="posts">
	<article class="card">
          <a href="/blog/2024/12/24/rust-projects-write-a-redis-clone/">
            <img src="/images/rust-projects-write-a-redis-clone.jpg" alt="rust-projects-write-a-redis-clone" />
          </a>
          <div class="body">
            <a href="/blog/2024/12/24/rust-projects-write-a-redis-clone/"><h2>Free book "Rust Projects - Write a Redis Clone"</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/rust/" class="tag">Rust</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2024-12-24T10:00:00+00:00">Dec 24, 2024</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2025/01/09/call-conventions-ownership-and-mutability-in-rust/">
            <img src="/images/call-conventions-ownership-and-mutability-in-rust.jpg" alt="call-conventions-ownership-and-mutability-in-rust" />
          </a>
          <div class="body">
            <a href="/blog/2025/01/09/call-conventions-ownership-and-mutability-in-rust/"><h2>Call conventions, ownership, and mutability in Rust</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">Assembly</a>
		<a href="/categories/compilers/" class="tag">compilers</a>
		<a href="/categories/rust/" class="tag">Rust</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2025-01-09T18:00:00+01:00">Jan 9, 2025</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/21/tdd-in-python-with-pytest-part-5/">
            <img src="/images/tdd-in-python-with-pytest-part-5.jpg" alt="tdd-in-python-with-pytest-part-5" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/21/tdd-in-python-with-pytest-part-5/"><h2>TDD in Python with pytest - Part 5</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-21T10:30:00+02:00">Sep 21, 2020</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-03-06T19:00:00+00:00">Mar 6, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/17/tdd-in-python-with-pytest-part-4/">
            <img src="/images/tdd-in-python-with-pytest-part-4.jpg" alt="tdd-in-python-with-pytest-part-4" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/17/tdd-in-python-with-pytest-part-4/"><h2>TDD in Python with pytest - Part 4</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-17T11:30:00+02:00">Sep 17, 2020</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/15/tdd-in-python-with-pytest-part-3/">
            <img src="/images/tdd-in-python-with-pytest-part-3.jpg" alt="tdd-in-python-with-pytest-part-3" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/15/tdd-in-python-with-pytest-part-3/"><h2>TDD in Python with pytest - Part 3</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-15T08:00:00+02:00">Sep 15, 2020</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/11/tdd-in-python-with-pytest-part-2/">
            <img src="/images/tdd-in-python-with-pytest-part-2.jpg" alt="tdd-in-python-with-pytest-part-2" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/11/tdd-in-python-with-pytest-part-2/"><h2>TDD in Python with pytest - Part 2</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-11T10:30:00+02:00">Sep 11, 2020</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2023-09-03T19:00:00+02:00">Sep 3, 2023</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/10/tdd-in-python-with-pytest-part-1/">
            <img src="/images/tdd-in-python-with-pytest-part-1.jpg" alt="tdd-in-python-with-pytest-part-1" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/10/tdd-in-python-with-pytest-part-1/"><h2>TDD in Python with pytest - Part 1</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-10T10:30:00+02:00">Sep 10, 2020</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2023-09-03T19:00:00+02:00">Sep 3, 2023</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/08/09/a-game-of-tokens-write-an-interpreter-in-python-with-tdd-part-5/">
            <img src="/images/a-game-of-tokens-5.jpg" alt="a-game-of-tokens-5" />
          </a>
          <div class="body">
            <a href="/blog/2020/08/09/a-game-of-tokens-write-an-interpreter-in-python-with-tdd-part-5/"><h2>A game of tokens: write an interpreter in Python with TDD - Part 5</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
		<a href="/categories/compilers/" class="tag">compilers</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-08-09T18:00:00+01:00">Aug 9, 2020</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/07/07/flask-project-setup-tdd-docker-postgres-and-more-part-3/">
            <img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-3.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-3" />
          </a>
          <div class="body">
            <a href="/blog/2020/07/07/flask-project-setup-tdd-docker-postgres-and-more-part-3/"><h2>Flask project setup: TDD, Docker, Postgres and more - Part 3</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/aws/" class="tag">AWS</a>
		<a href="/categories/devops/" class="tag">devops</a>
		<a href="/categories/docker/" class="tag">Docker</a>
		<a href="/categories/flask/" class="tag">Flask</a>
		<a href="/categories/http/" class="tag">HTTP</a>
		<a href="/categories/postgres/" class="tag">Postgres</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
		<a href="/categories/www/" class="tag">WWW</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-07-07T13:00:00+01:00">Jul 7, 2020</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-23T20:00:00+00:00">Feb 23, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/07/06/flask-project-setup-tdd-docker-postgres-and-more-part-2/">
            <img src="/images/flask-project-setup-tdd-docker-postgres-and-more-part-2.jpg" alt="flask-project-setup-tdd-docker-postgres-and-more-part-2" />
          </a>
          <div class="body">
            <a href="/blog/2020/07/06/flask-project-setup-tdd-docker-postgres-and-more-part-2/"><h2>Flask project setup: TDD, Docker, Postgres and more - Part 2</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/aws/" class="tag">AWS</a>
		<a href="/categories/devops/" class="tag">devops</a>
		<a href="/categories/docker/" class="tag">Docker</a>
		<a href="/categories/flask/" class="tag">Flask</a>
		<a href="/categories/http/" class="tag">HTTP</a>
		<a href="/categories/postgres/" class="tag">Postgres</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
		<a href="/categories/www/" class="tag">WWW</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-07-06T13:00:00+01:00">Jul 6, 2020</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-23T20:00:00+00:00">Feb 23, 2021</time></p>
	    </div>
          </div>
	</article>
      </div>
    </div>
  </section>
  
</div>

      </div>
    </div>
    <script src="/theme/js/packed.js?46a8f903"></script>

  </body>
</html>