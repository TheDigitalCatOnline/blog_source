<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>The Digital Cat - A simple example of Python OOP development (with TDD) - Part 2</title>
    <meta charset="utf-8" />
    <meta http-equiv='content-language' content='en-gb'>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="description" content="A blog featuring in-depth posts about Python, Scala, TDD, devops, security and all things development">
<meta name="description" content="A simple example of Python OOP development (with TDD) - Part 2">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@thedigicat" />
<meta name="twitter:title" content="A simple example of Python OOP development (with TDD) - Part 2" />
<meta name="twitter:description" content="Read the full post on The Digital Cat" />
<meta name="twitter:image" content="https://www.thedigitalcatonline.com/images/python-oop-tdd.jpg" />
    <script src="https://kit.fontawesome.com/15214b60ba.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,600;1,400;1,600&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="/theme/css/main.min.css?11abb51c">
    <link href="/images/global/favicon.jpg" rel="icon">
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74364524-1"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     
     gtag('config', 'UA-74364524-1');
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FZ55XG1KGG"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     
     gtag('config', 'G-FZ55XG1KGG');
    </script>
  </head>

  <body class="preload">
    <div class="container">
      <div class="sidebar navigation">
<nav>
<div class="links">
  <ul>
    <li class="link"><a href="/index.html">Homepage</a></li>
    <li class="link"><a href="/pages/about.html">About</a></li>
    <li class="link"><a href="/archives/index.html">Archives</a></li>
  </ul>
</div></nav>
<section>
  <header>
    <h2>Categories</h2>
  </header>
<ul>
  <li><a href="/category/programming/">Programming</a></li>
  <li><a href="/category/projects/">Projects</a></li>
  <li><a href="/category/retro/">Retro</a></li>
</ul></section>
<section>
  <header>
    <h2>Feeds</h2>
  </header>
<ul>
  <li><i class="fas fa-rss" aria-hidden="true"></i> <a href="/atom.xml">All posts</a></li>


  <li><i class="fas fa-rss" aria-hidden="true"></i> <a href="/category/programming/atom.xml">All posts in category: Programming</a></li>
</ul></section>
<section>
  <header>
    <h2>Tags</h2>
  </header>
<ul class="tags">
    <li class="tag tag-size-3">
      <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about amiga" href="/categories/amiga/">amiga</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about architectures" href="/categories/architectures/">architectures</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about assembly" href="/categories/assembly/">assembly</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about big data" href="/categories/big-data/">big data</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about blogging" href="/categories/blogging/">blogging</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about design" href="/categories/design/">design</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about devops" href="/categories/devops/">devops</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about distributed systems" href="/categories/distributed-systems/">distributed systems</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about ed25519" href="/categories/ed25519/">ed25519</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about editor" href="/categories/editor/">editor</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Emacs" href="/categories/emacs/">Emacs</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about HTML" href="/categories/html/">HTML</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about JavaScript" href="/categories/javascript/">JavaScript</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Lambda" href="/categories/lambda/">Lambda</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Markdown" href="/categories/markdown/">Markdown</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Mau" href="/categories/mau/">Mau</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Notebook" href="/categories/notebook/">Notebook</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about pelican" href="/categories/pelican/">pelican</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about pytest" href="/categories/pytest/">pytest</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Terraform" href="/categories/terraform/">Terraform</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about tools" href="/categories/tools/">tools</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul></section>
<section>
  <header>
    <h2>Get in touch</h2>
  </header>
  <ul class="contact">
    <li><i class="fab fa-twitter" aria-hidden="true"></i> <a href="https://twitter.com/thedigicat">Twitter</a></li>
    <li><i class="fab fa-github" aria-hidden="true"></i> <a href="https://github.com/TheDigitalCatOnline">GitHub</a></li>
  </ul>
</section>      </div>
      <div class="page">
	<header class="primary" >
	  <button type="button">
	    <i class="fas fa-bars"></i>
	  </button>
	  <p>The Digital Cat</p>
	</header>
	<div class="mobile-menu navigation">
<nav>
<div class="links">
  <ul>
    <li class="link"><a href="/index.html">Homepage</a></li>
    <li class="link"><a href="/pages/about.html">About</a></li>
    <li class="link"><a href="/archives/index.html">Archives</a></li>
  </ul>
</div></nav>
<section>
  <header>
    <h2>Categories</h2>
  </header>
<ul>
  <li><a href="/category/programming/">Programming</a></li>
  <li><a href="/category/projects/">Projects</a></li>
  <li><a href="/category/retro/">Retro</a></li>
</ul></section>
<section>
  <header>
    <h2>Tags</h2>
  </header>
<ul class="tags">
    <li class="tag tag-size-3">
      <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about amiga" href="/categories/amiga/">amiga</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about architectures" href="/categories/architectures/">architectures</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about assembly" href="/categories/assembly/">assembly</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about big data" href="/categories/big-data/">big data</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about blogging" href="/categories/blogging/">blogging</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about design" href="/categories/design/">design</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about devops" href="/categories/devops/">devops</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about distributed systems" href="/categories/distributed-systems/">distributed systems</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about ed25519" href="/categories/ed25519/">ed25519</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about editor" href="/categories/editor/">editor</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Emacs" href="/categories/emacs/">Emacs</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about HTML" href="/categories/html/">HTML</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about JavaScript" href="/categories/javascript/">JavaScript</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Lambda" href="/categories/lambda/">Lambda</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Markdown" href="/categories/markdown/">Markdown</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Mau" href="/categories/mau/">Mau</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Notebook" href="/categories/notebook/">Notebook</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about pelican" href="/categories/pelican/">pelican</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about pytest" href="/categories/pytest/">pytest</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Terraform" href="/categories/terraform/">Terraform</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about tools" href="/categories/tools/">tools</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul></section>	</div>
	
<div class="page-content">
  <header>
    <h1>A simple example of Python OOP development (with TDD) - Part 2</h1>
    <div class="post-info">
      <p>By Leonardo Giordani - <i class="fas fa-calendar-alt"></i> <time datetime="2015-09-10T20:00:00+01:00"> 10/09/2015</time></p>
      <p class="tags">
	<a class="tag category" href="/category/programming/" title="All posts in category Programming">Programming</a>
	<a class="tag" href="/categories/oop/">OOP</a>
	<a class="tag" href="/categories/python/">Python</a>
	<a class="tag" href="/categories/python3/">Python3</a>
	<a class="tag" href="/categories/tdd/">TDD</a>
	<a class="tag" href="/categories/testing/">testing</a>
      </p>
      <p class="share">Share on: <span><a class="" href="https://twitter.com/intent/tweet?text=A%20simple%20example%20of%20Python%20OOP%20development%20%28with%20TDD%29%20-%20Part%202&url=https%3A//www.thedigitalcatonline.com/blog/2015/09/10/python-oop-tdd-example-part2/&via=thedigicat&hashtags=oop,python,python3,tdd,testing" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i> Twitter</a></span>
<span><a class="" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//www.thedigitalcatonline.com/blog/2015/09/10/python-oop-tdd-example-part2/&title=A%20simple%20example%20of%20Python%20OOP%20development%20%28with%20TDD%29%20-%20Part%202&summary=&source=https%3A//www.thedigitalcatonline.com/blog/2015/09/10/python-oop-tdd-example-part2/" target="_blank" title="Share on LinkedIn"><i class="fab fa-linkedin"></i> LinkedIn</a></span>
<span><a class="" href="https://news.ycombinator.com/submitlink?t=A%20simple%20example%20of%20Python%20OOP%20development%20%28with%20TDD%29%20-%20Part%202&u=https%3A//www.thedigitalcatonline.com/blog/2015/09/10/python-oop-tdd-example-part2/" target="_blank" title="Share on HackerNews"><i class="fab fa-hacker-news"></i> HackerNews</a></span>
<span><a class="" href="mailto:?subject=A%20simple%20example%20of%20Python%20OOP%20development%20%28with%20TDD%29%20-%20Part%202&amp;body=https%3A//www.thedigitalcatonline.com/blog/2015/09/10/python-oop-tdd-example-part2/" target="_blank" title="Share via Email"><i class="fas fa-envelope"></i> Email</a></span>
<span><a class="" href="https://www.reddit.com/submit?url=https%3A//www.thedigitalcatonline.com/blog/2015/09/10/python-oop-tdd-example-part2/&title=A%20simple%20example%20of%20Python%20OOP%20development%20%28with%20TDD%29%20-%20Part%202" target="_blank" title="Share via Reddit"><i class="fab fa-reddit"></i> Reddit</a></span></p>    
    </div>
  </header>
  
  <div class="post-content">
    <p>In <a href="https://www.thedigitalcatonline.com/blog/2015/05/13/python-oop-tdd-example-part1/">the first part</a> of this small series I introduced you to TDD with Python by means of the powerful <code>py.test</code> package. We developed together a simple library which provides a <code>Binary</code> class that is a bit more useful than the default binary representation that Python provides with the <code>bin()</code> builtin function.</p>
<p>In this part I'll go on with the development of the library, discussing the implementation of a binary number with a fixed size, which is a very interesting and useful matter, being the foundation of the computer we are working with. Fixed-size binaries may also represent negative numbers with the two's complement technique, and this will be an important point to test.</p>
<p>You may happen to dislike some decisions about the interface or the behaviour of the resulting class. Since this post is just a way to show you a concrete TDD session you are totally free to change the tests and to come up with a better solution than mine. Feel free to get in touch and submit better ideas, I'm always looking for something new to learn.</p>
<p>As already suggested in the first instalment try to follow the post up to the section where I write the tests. Then move on implementing your own class and try to make it pass all the tests: this is the best way for you to learn TDD, actually applying it.</p>
<h2 id="fixed-size-binaries">Fixed-size binaries<a class="headerlink" href="#fixed-size-binaries" title="Permanent link">&para;</a></h2>
<p>As soon as you build an electronic circuit to store information (a flip-flop, for example) you start dealing with binary numbers and with fixed-size quantities. Limiting the number of digits brings immediately the limitation of having a maximum number that can be represented and requires to decide what to do with bigger numbers. Another issue that arises is that of the representation of negative numbers. Since we can only use two symbols (one and zero) we have to decide a "syntax" for negative values.</p>
<p>You will find a lot of information about some of those issues in the following Wikipedia articles: <a href="https://en.wikipedia.org/wiki/Integer_overflow">Integer overflow</a> and <a href="https://en.wikipedia.org/wiki/Signed_number_representations">signed number representations</a>. Check also this page on <a href="https://en.wikipedia.org/wiki/Bitwise_operation">bitwise operations</a> as some of them will be implemented.</p>
<h2 id="object-interface">Object interface<a class="headerlink" href="#object-interface" title="Permanent link">&para;</a></h2>
<p>So we aim to create a class called <code>SizeBinary</code> that provides the following interface:</p>
<ul>
<li>Can be instantiated giving a size in bits and a value. The value is optional, if not specified is 0.</li>
<li>The value can be set after instantiation with a <code>set()</code> method.</li>
<li>If instantiated or set with a value greater than the maximum representable one the <code>overflow</code> attribute of the object becomes <code>True</code>.</li>
<li>May initialized with all the data types supported by the <code>Binary</code> class developed in the first post.</li>
<li>Just like the <code>Binary</code> class may be converted into an integer (e.g. <code>42</code>, a binary string (e.g. <code>0b101010</code>, an hexadecimal string (<code>0x2a</code>) and a bit string (<code>101010</code>). May also be converted to a <code>Binary</code> without size limitations.</li>
<li>Support binary logic operations such as: NOT, AND, OR, XOR, shift left and right (without carry).</li>
<li>Can be splitted in two arbitrary sized <code>SizeBinary</code> objects.</li>
<li>Can be negated with both one's complement and two's complement techniques.</li>
</ul>
<p>So now, obeying the TDD methodology, I will write some tests that exploit these features. After this I'm going to develop an object that makes all test pass. Like we did in the previous post you may follow along as I write te tests and then write your own class.</p>
<h3 id="initialization">Initialization<a class="headerlink" href="#initialization" title="Permanent link">&para;</a></h3>
<p>The <code>SizeBinary</code> object shall support all the initialization options supported by <code>Binary</code>, but its main interface is different because when creating a <code>SizeBinary</code> we must be allowed to specify the size. The first tests are though pretty straightforward.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_size_binary_init_int</span><span class="p">():</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">int</span><span class="p">(</span><span class="n">size_binary</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>

<span class="k">def</span> <span class="nf">test_size_binary_init_int_overflow</span><span class="p">():</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">int</span><span class="p">(</span><span class="n">size_binary</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">overflow</span> <span class="o">==</span> <span class="kc">True</span>

<span class="k">def</span> <span class="nf">test_size_binary_set</span><span class="p">():</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">size_binary</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">size_binary</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;00010110&#39;</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">overflow</span> <span class="o">==</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">test_size_binary_set_overflow</span><span class="p">():</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">size_binary</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">size_binary</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;00000000&#39;</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">overflow</span> <span class="o">==</span> <span class="kc">True</span>
</code></pre></div>

<p>I will cover all the cases already covered for the <code>Binary</code> class. As you can see, I'm specifying the bit size when instantiating the object and testing the overflow condition. Other initialization and conversion tests are very similar to their <code>Binary</code> counterpart and I will not copy them here, as you can find them in the source code.</p>
<h2 id="splitting">Splitting<a class="headerlink" href="#splitting" title="Permanent link">&para;</a></h2>
<p>One of the requirements is to provide a method to split a <code>SizeBinary</code> object into two arbitrarily sized <code>Binary</code> objects. The tests are</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_size_binary_split</span><span class="p">():</span>
    <span class="n">size_binary8</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;01010110&#39;</span><span class="p">)</span>
    <span class="n">size_binary4u</span><span class="p">,</span> <span class="n">size_binary4l</span> <span class="o">=</span> <span class="n">size_binary8</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">size_binary4u</span><span class="p">,</span> <span class="n">size_binary4l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">SizeBinary</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;0101&#39;</span><span class="p">),</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;0110&#39;</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">test_size_binary_split_asymmetric</span><span class="p">():</span>
    <span class="n">size_binary8</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;01010110&#39;</span><span class="p">)</span>
    <span class="n">size_binary9u</span><span class="p">,</span> <span class="n">size_binary3l</span> <span class="o">=</span> <span class="n">size_binary8</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">size_binary9u</span><span class="p">,</span> <span class="n">size_binary3l</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">SizeBinary</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;000001010&#39;</span><span class="p">),</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;110&#39;</span><span class="p">))</span>
</code></pre></div>

<p>As you can see the split shall be able to pad the resulting values if the number of bits exceedes that of the available ones.</p>
<h2 id="negative-numbers">Negative numbers<a class="headerlink" href="#negative-numbers" title="Permanent link">&para;</a></h2>
<p>There are many techniques to represent negative numbers with binary digits, and there is no way to tell from a binary number neither if it is positive or negative nor which technique has been used. It is a matter of conventions into the system in use. We want to implement <a href="https://en.wikipedia.org/wiki/Ones'_complement">one's complement</a> and <a href="https://en.wikipedia.org/wiki/Two's_complement">two's complement</a>, which are described in detail in the linked Wikipedia articles. The tests to check the correct behaviour are</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_size_binary_OC</span><span class="p">():</span>
    <span class="c1"># 6 = 0b00000110 -&gt; 0b11111001</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">oc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;11111001&#39;</span><span class="p">)</span>

    <span class="c1"># 7 = 0b00000111 -&gt; 0b11111000</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">oc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;11111000&#39;</span><span class="p">)</span>

    <span class="c1"># 15 = 0b00001111 -&gt; 0b11110000</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">oc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;11110000&#39;</span><span class="p">)</span>

    <span class="c1"># 15 = 0b0000000000001111 -&gt; 0b1111111111110000</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">oc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;1111111111110000&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_size_binary_TC</span><span class="p">():</span>
    <span class="c1"># 6 = 0b00000110 -&gt; 0b11111010</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">tc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;11111010&#39;</span><span class="p">)</span>

    <span class="c1"># 7 = 0b00000111 -&gt; 0b11111001</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">tc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;11111001&#39;</span><span class="p">)</span>

    <span class="c1"># 15 = 0b00001111 -&gt; 0b11110001</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">tc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;11110001&#39;</span><span class="p">)</span>

    <span class="c1"># 15 = 0b0000000000001111 -&gt; 0b1111111111110001</span>
    <span class="n">size_binary</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">size_binary</span><span class="o">.</span><span class="n">tc</span><span class="p">()</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;1111111111110001&#39;</span><span class="p">)</span>
</code></pre></div>

<h2 id="mathematics-indexing-and-slicing">Mathematics, indexing and slicing<a class="headerlink" href="#mathematics-indexing-and-slicing" title="Permanent link">&para;</a></h2>
<p>The basic mathematical and logical operations are the same implemented for the <code>Binary</code> class. Some tests have been added to check what happens when performing operations between two <code>SizeBinary</code> with a different size. We expect the result to have the size of the bigger of the two operands.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_binary_addition_int</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_binary_addition_binary</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_binary_addition_binary_different_size</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</code></pre></div>

<p>Being very straightforward, I do not copy here all the tests written to cover this part, you will find them in the source code.</p>
<p>Even the shift left operation now drops bits if there is not enough space for them, while the <code>Binary</code> class did it only for the shift right operation. For simplicity's sake I didn't implement a carry flag, i.e. there is no way to retrieve the bits shifted outside the available space. You are free to try and implement it, it's a good exercise but remember to write tests first!</p>
<p>The indexing and slicing operations are basically the same as in the <code>Binary</code> case. The slicing operation produces a new <code>SizeBinary</code> with the correct size.</p>
<h2 id="implementation-time">Implementation time!<a class="headerlink" href="#implementation-time" title="Permanent link">&para;</a></h2>
<p>Now be a good OOP programmer and go, write a class that passes all the tests you find in the <a href="/code/python-oop-tdd-part2/test_size_binary.py">source code</a>. Just an advice, before you start headlong: being a <code>SizeBinary</code> mostly a <code>Binary</code> object with some new features it is recommended to use inheritance as the key delegation technique.</p>
<h2 id="my-solution">My solution<a class="headerlink" href="#my-solution" title="Permanent link">&para;</a></h2>
<p>Following my own advice my <code>SizeBinary</code> class inherits from <code>Binary</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">binary</span> <span class="kn">import</span> <span class="n">Binary</span>

<span class="k">class</span> <span class="nc">SizeBinary</span><span class="p">(</span><span class="n">Binary</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>

<p>and with this simple declaration I get 1 test passed and still 50 to go. We obviously may also create a new object that does not inherit from <code>Binary</code> but we would have to explicitly delegate a lot of functions to the latter class. So, in this case, better to stick to an automatic delegation mechanism like inheritance. To get a review of those two concepts read <a href="https://www.thedigitalcatonline.com/blog/2014/08/20/python-3-oop-part-3-delegation-composition-and-inheritance/">this post</a>.</p>
<p>Composition could be another viable solution, with a <code>Binary</code> value stored internally and accessed whenever we call <code>super()</code> in the inheritance version. In this case, however, inheritance and composition lead to very similar results, with the latter being somehow counter-intuitive and thus not the best choice.</p>
<p>We need to reimplement many of the special methods already implemented in the <code>Binary</code> class. This because Python resolves magic methods through a dedicated channel that avoids the <code>__getattr__()</code> and <code>__getattribute__()</code> methods, making the whole thing faster. This makes impossible to automatically delegate magic methods, except by means of metaclasses, which are however too complex to be a useful addition to this post.</p>
<p>The initialization function shall store the bit length and initialize a flag to signal the overflow condition. Since I also want to have a <code>set()</code> function that changes the value I implement it and call it in the <code>__init__()</code> method.</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bits</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">=</span> <span class="n">bits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overflow</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">binary</span> <span class="o">=</span> <span class="n">Binary</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">upper</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">upper</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overflow</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">Binary</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span><span class="o">.</span><span class="n">_value</span>
</code></pre></div>

<p>I'm not that happy to poke into the <code>Binary</code> class implementation setting the <code>_value</code> attribute, but this is the only way to change the value of the underlying <code>Binary</code> class. If the <code>Binary</code> class had a <code>set()</code> method we could call it through <code>super()</code>, and I cannot directly set it through <code>__init__()</code> because I need to check the overflow condition.</p>
<p>With this code I get a surprising result of 37 passed tests, while 14 still refuse to let me call it a day. This is however misleading, as many tests assume the <code>SizeBinary</code> object correctly performs comparison, which is not the case, as shown by the failure of the <code>test_binary_equality_checks_bits</code> test.</p>
<p>This was done on purpose, to show you that writing tests is not something that automatically guarantees you to have correct code. As a matter of fact, in this case tests like</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_binary_addition_int</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div>

<p>do not fail, even if the result of the addition is a <code>Binary</code> and not a <code>SizeBinary</code>.</p>
<p>Let us check why this happens. The <code>SizeBinary</code> object is also a <code>Binary</code> object, and its <code>__add__()</code> method returns a <code>Binary</code>. The subsequent comparison is made using the <code>__eq__()</code> method of the <code>Binary</code> class, since the <code>SizeBinary</code> one does not provide its own version of the comparison. Since <code>Binary</code> classes just compare their value the test ends successfully.</p>
<p>Let us add some code to implement the correct comparision</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bits</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">bits</span>
</code></pre></div>

<p>which adds a check on the number of bits to the check already made by the <code>Binary</code> class. This results in 35 failed tests and 16 passed, showing that the previous result was biased by "inaccurate" tests. As a matter of fact, the presence of a test that shows if the comparison is correct or not makes perfectly reasonable to have tests that take it for granted.</p>
<p>One simple thing to add is the right padding with zeros that shall be provided for input values that are shorter than the given number of bits</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
</code></pre></div>

<p>And this simple addition lowers the count of failed tests from 35 to 30. Another small addition that satisfies 2 more tests is the splitting function, which shall return <code>SizeBinary</code> objects instead of <code>Binary</code> ones</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upper_bits</span><span class="p">,</span> <span class="n">lower_bits</span><span class="p">):</span>
        <span class="n">upper</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">lower_bits</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="n">upper_bits</span><span class="p">,</span> <span class="n">upper</span><span class="p">),</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="n">lower_bits</span><span class="p">,</span> <span class="n">lower</span><span class="p">)</span>
</code></pre></div>

<p>As already explained we want to get the negative version of the number both with the one's complement and the two's complement techniques. For starters, let's deal with one's complement.</p>
<p>A very smart way to reverse all the n bits of a value x is to compute <code>(1 &lt;&lt; n) - x - 1</code>. An example will show you that this works, avoiding long and boring mathematical explanations. We want to negate the number 1 represented as 8 bits ('00000001'). First we compute <code>1 &lt;&lt; 8</code> which returns <code>100000000</code>, then we subtract the value 1 of the number which returns <code>1111111</code> and finally we subtract the constant 1, which returns <code>11111110</code>. Look and behold! So this is exactly what I will implement for my <code>oc()</code> function</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">oc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>From the same boring mathematics tomes we may discover that the two's complement representation of a number is its one's complement version plus 1. So the implementation of <code>tc()</code> is straightforward</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">tc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oc</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div>

<p>As a matter of fact this function doesn't make the relative test (<code>test_size_binary_TC</code>) pass, because it depends on the correct implementation of the sum operation, which is still not implemented. So now the updated battle report is: 27 failed, 24 passed.</p>
<p>Right and left shifts are the same of the <code>Binary</code> class, except that the result shall fit into the given bits. So we may delegate them to the <code>Binary</code> class implementation</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="fm">__lshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">,</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__lshift__</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__rshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">,</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__rshift__</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
</code></pre></div>

<p>And this is enough to make the 5 related tests pass.</p>
<p>Now it's time for some arithmetic and logic functions. Since the internal representation of our value is always in base 10, as already done with the arithmetic functions of the <code>Binary</code> class we may go back to the base-10 world, perform the requested operation, and go back to the base-2 representation.</p>
<p>The problem with those functions is that if we mix binaries with different sizes we want to "promote" the smaller one, to that the result has the size of the bigger. To handle this situation I isolated some code in a helper function called <code>_max_and_convert()</code></p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">_max_and_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">other_bits</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">bits</span>
            <span class="n">sb_other</span> <span class="o">=</span> <span class="n">other</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">other_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bits</span>
            <span class="n">sb_other</span> <span class="o">=</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="n">other_bits</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">,</span> <span class="n">other_bits</span><span class="p">),</span> <span class="n">sb_other</span>
</code></pre></div>

<p>It checks if the <code>other</code> argument has a <code>bits</code> attribute, otherwise converts it into a <code>SizeBinary</code>. Then it returns the converted argument and the greatest length between the latter and <code>self</code>. Using this function I can then implement some magic methods such as</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">bits</span><span class="p">,</span> <span class="n">sb_other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_and_convert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">sb_other</span><span class="p">))</span>
</code></pre></div>

<p>This template is used to implement <code>__add__()</code>, <code>__sub__()</code>, <code>__mul__()</code>, <code>__truediv__()</code>, <code>__and__()</code>, <code>__or__()</code>, <code>__xor__()</code>. The <code>__invert__()</code> method is simpler, missing the second argument</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bits</span><span class="p">,</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__invert__</span><span class="p">())</span>
</code></pre></div>

<p>With those functions I now have 49 successful tests and 2 still failing, namely <code>test_size_binary_to_binary</code> and <code>test_binary_slice</code>. The first one depends on the missing <code>to_binary()</code> method</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">to_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Binary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>

<p>The second needs some consideration: slicing depends on the <code>__getitem__()</code> magic method, which is used also for the simple indexing, tested by <code>test_binary_get_bit</code> and <code>test_binary_negative_index</code>, for example. The requested behaviour of the <code>SizeBinary</code> class is to return a single character when indexing a single bit and a <code>SizeBinary</code> or the correct length when slicing. The following code handles both situations</p>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">bits</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SizeBinary</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>
</code></pre></div>

<p>First of all I use the slicing function of the underlying <code>Binary</code> object which was already tested and correctly working. Then I compute the length of that result and act depending on the result.</p>
<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h2>
<ul>
<li>Wikipedia entries on <a href="https://en.wikipedia.org/wiki/Integer_overflow">integer overflow</a>, <a href="https://en.wikipedia.org/wiki/Signed_number_representations">signed number representations</a>, and <a href="https://en.wikipedia.org/wiki/Bitwise_operation">bitwise operations</a>.</li>
</ul>
<p>The code developed in this post can be found here:</p>
<ul>
<li>The full code of the <code>SizeBinary</code> class is <a href="/code/python-oop-tdd-part2/size_binary.py">here</a>, while the tests file is <a href="/code/python-oop-tdd-part2/test_size_binary.py">here</a>.</li>
<li><a href="/code/python-oop-tdd-part2/binary.zip">Here</a> you find a zip file containing both source code files and the relative tests.</li>
</ul>
<h2 id="feedback">Feedback<a class="headerlink" href="#feedback" title="Permanent link">&para;</a></h2>
<p>The <a href="https://github.com/TheDigitalCatOnline/thedigitalcatonline.github.com/issues">GitHub issues</a> page is the best place to submit corrections.</p>
  </div>

  <section class="links">
    <header>
      <h2>Part 2 of the Python OOP and TDD series</h2>
    </header>
    <div>
      <h3>Previous articles</h3>
      <ul>
        <li><a href="/blog/2015/05/13/python-oop-tdd-example-part1/">A simple example of Python OOP development (with TDD) - Part 1</a></li>
      </ul>
      
    </div>
  </section>

  <section>
    <header>
      <h2>Related Posts</h2>
    </header>
    <div class="paginated-posts">
      <div class="posts">
	<article class="card">
          <a href="/blog/2018/12/20/cabook/">
            <img src="/images/cabook.jpg" alt="cabook" />
          </a>
          <div class="body">
            <a href="/blog/2018/12/20/cabook/"><h2>Clean Architectures in Python: the book</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python2/" class="tag">Python2</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
		<a href="/categories/architectures/" class="tag">architectures</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2018-12-20T08:00:00+01:00">Dec 20, 2018</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-08-22T08:00:00+00:00">Aug 22, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/21/tdd-in-python-with-pytest-part-5/">
            <img src="/images/tdd-in-python-with-pytest-part-5.jpg" alt="tdd-in-python-with-pytest-part-5" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/21/tdd-in-python-with-pytest-part-5/"><h2>TDD in Python with pytest - Part 5</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-21T10:30:00+02:00">Sep 21, 2020</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-03-06T19:00:00+00:00">Mar 6, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/10/tdd-in-python-with-pytest-part-1/">
            <img src="/images/tdd-in-python-with-pytest-part-1.jpg" alt="tdd-in-python-with-pytest-part-1" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/10/tdd-in-python-with-pytest-part-1/"><h2>TDD in Python with pytest - Part 1</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-10T10:30:00+02:00">Sep 10, 2020</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-26T19:00:00+02:00">Feb 26, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/17/tdd-in-python-with-pytest-part-4/">
            <img src="/images/tdd-in-python-with-pytest-part-4.jpg" alt="tdd-in-python-with-pytest-part-4" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/17/tdd-in-python-with-pytest-part-4/"><h2>TDD in Python with pytest - Part 4</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-17T11:30:00+02:00">Sep 17, 2020</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/15/tdd-in-python-with-pytest-part-3/">
            <img src="/images/tdd-in-python-with-pytest-part-3.jpg" alt="tdd-in-python-with-pytest-part-3" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/15/tdd-in-python-with-pytest-part-3/"><h2>TDD in Python with pytest - Part 3</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-15T08:00:00+02:00">Sep 15, 2020</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2020/09/11/tdd-in-python-with-pytest-part-2/">
            <img src="/images/tdd-in-python-with-pytest-part-2.jpg" alt="tdd-in-python-with-pytest-part-2" />
          </a>
          <div class="body">
            <a href="/blog/2020/09/11/tdd-in-python-with-pytest-part-2/"><h2>TDD in Python with pytest - Part 2</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2020-09-11T10:30:00+02:00">Sep 11, 2020</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2016/03/06/python-mocks-a-gentle-introduction-part-1/">
            <img src="/images/python-mocks.jpg" alt="python-mocks" />
          </a>
          <div class="body">
            <a href="/blog/2016/03/06/python-mocks-a-gentle-introduction-part-1/"><h2>Python Mocks: a gentle introduction - Part 1</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/decorators/" class="tag">decorators</a>
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python2/" class="tag">Python2</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2016-03-06T18:00:00+01:00">Mar 6, 2016</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2019-02-27T23:30:00+00:00">Feb 27, 2019</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2017/07/21/refactoring-with-test-in-python-a-practical-example/">
            <img src="/images/refactoring-with-tests-in-python.jpg" alt="refactoring-with-tests-in-python" />
          </a>
          <div class="body">
            <a href="/blog/2017/07/21/refactoring-with-test-in-python-a-practical-example/"><h2>Refactoring with tests in Python: a practical example</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/refactoring/" class="tag">refactoring</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2017-07-21T09:30:00+01:00">Jul 21, 2017</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2016/09/27/python-mocks-a-gentle-introduction-part-2/">
            <img src="/images/python-mocks.jpg" alt="python-mocks" />
          </a>
          <div class="body">
            <a href="/blog/2016/09/27/python-mocks-a-gentle-introduction-part-2/"><h2>Python Mocks: a gentle introduction - Part 2</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/decorators/" class="tag">decorators</a>
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python2/" class="tag">Python2</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2016-09-27T09:00:00+00:00">Sep 27, 2016</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2015/05/13/python-oop-tdd-example-part1/">
            <img src="/images/python-oop-tdd.jpg" alt="python-oop-tdd" />
          </a>
          <div class="body">
            <a href="/blog/2015/05/13/python-oop-tdd-example-part1/"><h2>A simple example of Python OOP development (with TDD) - Part 1</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/oop/" class="tag">OOP</a>
		<a href="/categories/pytest/" class="tag">pytest</a>
		<a href="/categories/python/" class="tag">Python</a>
		<a href="/categories/python3/" class="tag">Python3</a>
		<a href="/categories/tdd/" class="tag">TDD</a>
		<a href="/categories/testing/" class="tag">testing</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2015-05-13T17:00:00+01:00">May 13, 2015</time></p>
	    </div>
          </div>
	</article>
      </div>
    </div>
  </section>
  
</div>

      </div>
    </div>
    <script src="/theme/js/packed.js?46a8f903"></script>

  </body>
</html>