<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>The Digital Cat - Exploring the Amiga - Part 1</title>
    <meta charset="utf-8" />
    <meta http-equiv='content-language' content='en-gb'>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="description" content="A blog featuring in-depth posts about Python, Scala, TDD, devops, security and all things development">
<meta name="description" content="How to disassemble Amiga binaries and a discussion of the LEA instruction and relative offsets">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@thedigicat" />
<meta name="twitter:title" content="Exploring the Amiga - Part 1" />
<meta name="twitter:description" content="How to disassemble Amiga binaries and a discussion of the LEA instruction and relative offsets" />
<meta name="twitter:image" content="https://www.thedigitalcatonline.com/images/exploring-the-amiga-1.jpg" />
    <script src="https://kit.fontawesome.com/15214b60ba.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,600;1,400;1,600&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="/theme/css/main.min.css?f6765de3">
    <link href="/images/global/favicon.jpg" rel="icon">
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74364524-1"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     
     gtag('config', 'UA-74364524-1');
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FZ55XG1KGG"></script>
    <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());
     
     gtag('config', 'G-FZ55XG1KGG');
    </script>
  </head>

  <body class="preload">
    <div class="container">
      <div class="sidebar navigation">
<nav>
<div class="links">
  <ul>
    <li class="link"><a href="/index.html">Homepage</a></li>
    <li class="link"><a href="/pages/about.html">About</a></li>
    <li class="link"><a href="/archives/index.html">Archives</a></li>
  </ul>
</div></nav>
<section>
  <article class="card">
    <a href="https://www.thedigitalcat.academy/freebie-first-class-objects">
      <img src="/images/first-class-objects-in-python.jpg" />
    </a>
    <div class="body">
      <h2>First-class objects in Python</h2>
      <p>Higher-order functions, wrappers, and factories</p>
      <div class="actions">
        <a class="action" href="https://www.thedigitalcat.academy/freebie-first-class-objects">Get your FREE copy</a>
      </div>
    </div>
  </article>
</section>
<section>
  <header>
    <h2>Tags</h2>
  </header>
<ul class="tags">
    <li class="tag tag-size-3">
      <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about amiga" href="/categories/amiga/">amiga</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about architecture" href="/categories/architecture/">architecture</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about architectures" href="/categories/architectures/">architectures</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about assembly" href="/categories/assembly/">assembly</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about big data" href="/categories/big-data/">big data</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about blogging" href="/categories/blogging/">blogging</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about design" href="/categories/design/">design</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about devops" href="/categories/devops/">devops</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about distributed systems" href="/categories/distributed-systems/">distributed systems</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about ed25519" href="/categories/ed25519/">ed25519</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about editor" href="/categories/editor/">editor</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Emacs" href="/categories/emacs/">Emacs</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about HTML" href="/categories/html/">HTML</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about JavaScript" href="/categories/javascript/">JavaScript</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Lambda" href="/categories/lambda/">Lambda</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Markdown" href="/categories/markdown/">Markdown</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Mau" href="/categories/mau/">Mau</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about networking" href="/categories/networking/">networking</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Notebook" href="/categories/notebook/">Notebook</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about pelican" href="/categories/pelican/">pelican</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about pytest" href="/categories/pytest/">pytest</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Terraform" href="/categories/terraform/">Terraform</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about tools" href="/categories/tools/">tools</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul></section>
<section>
  <header>
    <h2>Categories</h2>
  </header>
<ul>
  <li><a href="/category/programming/">Programming</a></li>
  <li><a href="/category/projects/">Projects</a></li>
  <li><a href="/category/retro/">Retro</a></li>
</ul></section>
<section>
  <header>
    <h2>Feeds</h2>
  </header>
<ul>
  <li><i class="fas fa-rss" aria-hidden="true"></i> <a href="/atom.xml">All posts</a></li>


  <li><i class="fas fa-rss" aria-hidden="true"></i> <a href="/category/retro/atom.xml">All posts in category: Retro</a></li>
</ul></section>
<section>
  <header>
    <h2>Get in touch</h2>
  </header>
  <ul class="contact">
    <li><i class="fab fa-twitter" aria-hidden="true"></i> <a href="https://twitter.com/thedigicat">Twitter</a></li>
    <li><i class="fab fa-github" aria-hidden="true"></i> <a href="https://github.com/TheDigitalCatOnline">GitHub</a></li>
  </ul>
</section>      </div>
      <div class="page">
	<header class="primary" >
	  <button type="button">
	    <i class="fas fa-bars"></i>
	  </button>
	  <p>The Digital Cat</p>
	</header>
	<div class="mobile-menu navigation">
<nav>
<div class="links">
  <ul>
    <li class="link"><a href="/index.html">Homepage</a></li>
    <li class="link"><a href="/pages/about.html">About</a></li>
    <li class="link"><a href="/archives/index.html">Archives</a></li>
  </ul>
</div></nav>
<section>
  <header>
    <h2>Categories</h2>
  </header>
<ul>
  <li><a href="/category/programming/">Programming</a></li>
  <li><a href="/category/projects/">Projects</a></li>
  <li><a href="/category/retro/">Retro</a></li>
</ul></section>
<section>
  <header>
    <h2>Tags</h2>
  </header>
<ul class="tags">
    <li class="tag tag-size-3">
      <a title="Posts about algorithms" href="/categories/algorithms/">algorithms</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about amiga" href="/categories/amiga/">amiga</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about AMQP" href="/categories/amqp/">AMQP</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about architecture" href="/categories/architecture/">architecture</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about architectures" href="/categories/architectures/">architectures</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about assembly" href="/categories/assembly/">assembly</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about AWS" href="/categories/aws/">AWS</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about big data" href="/categories/big-data/">big data</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about blogging" href="/categories/blogging/">blogging</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about C" href="/categories/c/">C</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Clojure" href="/categories/clojure/">Clojure</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about compilers" href="/categories/compilers/">compilers</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about concurrent programming" href="/categories/concurrent-programming/">concurrent programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about cryptography" href="/categories/cryptography/">cryptography</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about decorators" href="/categories/decorators/">decorators</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about design" href="/categories/design/">design</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about devops" href="/categories/devops/">devops</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about distributed systems" href="/categories/distributed-systems/">distributed systems</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Django" href="/categories/django/">Django</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Docker" href="/categories/docker/">Docker</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about ed25519" href="/categories/ed25519/">ed25519</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about editor" href="/categories/editor/">editor</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Emacs" href="/categories/emacs/">Emacs</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Erlang" href="/categories/erlang/">Erlang</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Flask" href="/categories/flask/">Flask</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about functional programming" href="/categories/functional-programming/">functional programming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about generators" href="/categories/generators/">generators</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Git" href="/categories/git/">Git</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about HTML" href="/categories/html/">HTML</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about HTTP" href="/categories/http/">HTTP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about infrastructure" href="/categories/infrastructure/">infrastructure</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about JavaScript" href="/categories/javascript/">JavaScript</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Lambda" href="/categories/lambda/">Lambda</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about M68000" href="/categories/m68000/">M68000</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Markdown" href="/categories/markdown/">Markdown</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Mau" href="/categories/mau/">Mau</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaclasses" href="/categories/metaclasses/">metaclasses</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about metaprogramming" href="/categories/metaprogramming/">metaprogramming</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about networking" href="/categories/networking/">networking</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Notebook" href="/categories/notebook/">Notebook</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about OOP" href="/categories/oop/">OOP</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about operating systems" href="/categories/operating-systems/">operating systems</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about pelican" href="/categories/pelican/">pelican</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Pika" href="/categories/pika/">Pika</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about Postage" href="/categories/postage/">Postage</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Postgres" href="/categories/postgres/">Postgres</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about pytest" href="/categories/pytest/">pytest</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python" href="/categories/python/">Python</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Python2" href="/categories/python2/">Python2</a>
    </li>
    <li class="tag tag-size-1">
      <a title="Posts about Python3" href="/categories/python3/">Python3</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about RabbitMQ" href="/categories/rabbitmq/">RabbitMQ</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about refactoring" href="/categories/refactoring/">refactoring</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about retroprogramming" href="/categories/retroprogramming/">retroprogramming</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about RSA" href="/categories/rsa/">RSA</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about Scala" href="/categories/scala/">Scala</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSH" href="/categories/ssh/">SSH</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about SSL" href="/categories/ssl/">SSL</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about TDD" href="/categories/tdd/">TDD</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about Terraform" href="/categories/terraform/">Terraform</a>
    </li>
    <li class="tag tag-size-2">
      <a title="Posts about testing" href="/categories/testing/">testing</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about tools" href="/categories/tools/">tools</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about versioning" href="/categories/versioning/">versioning</a>
    </li>
    <li class="tag tag-size-4">
      <a title="Posts about video" href="/categories/video/">video</a>
    </li>
    <li class="tag tag-size-3">
      <a title="Posts about WWW" href="/categories/www/">WWW</a>
    </li>
</ul></section>	</div>
	
<div class="page-content">
  <header>
    <h1>Exploring the Amiga - Part 1</h1>
    <div class="post-info">
      <p>By Leonardo Giordani - <i class="fas fa-calendar-alt"></i> <time datetime="2018-05-28T14:00:00+01:00"> 28/05/2018</time> <i class="fas fa-edit"></i> Updated on <time datetime="2021-02-26T08:00:00+00:00">Feb 26, 2021</time></p>
      <p class="tags">
	<a class="tag category" href="/category/retro/" title="All posts in category Retro">Retro</a>
	<a class="tag" href="/categories/assembly/">assembly</a>
	<a class="tag" href="/categories/amiga/">amiga</a>
	<a class="tag" href="/categories/retroprogramming/">retroprogramming</a>
      </p>
      <p class="share">Share on: <span><a class="" href="https://twitter.com/intent/tweet?text=Exploring%20the%20Amiga%20-%20Part%201&url=https%3A//www.thedigitalcatonline.com/blog/2018/05/28/exploring-the-amiga-1/&via=thedigicat&hashtags=assembly,amiga,retroprogramming" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i> Twitter</a></span>
<span><a class="" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//www.thedigitalcatonline.com/blog/2018/05/28/exploring-the-amiga-1/&title=Exploring%20the%20Amiga%20-%20Part%201&summary=How%20to%20disassemble%20Amiga%20binaries%20and%20a%20discussion%20of%20the%20LEA%20instruction%20and%20relative%20offsets&source=https%3A//www.thedigitalcatonline.com/blog/2018/05/28/exploring-the-amiga-1/" target="_blank" title="Share on LinkedIn"><i class="fab fa-linkedin"></i> LinkedIn</a></span>
<span><a class="" href="https://news.ycombinator.com/submitlink?t=Exploring%20the%20Amiga%20-%20Part%201&u=https%3A//www.thedigitalcatonline.com/blog/2018/05/28/exploring-the-amiga-1/" target="_blank" title="Share on HackerNews"><i class="fab fa-hacker-news"></i> HackerNews</a></span>
<span><a class="" href="mailto:?subject=Exploring%20the%20Amiga%20-%20Part%201&amp;body=https%3A//www.thedigitalcatonline.com/blog/2018/05/28/exploring-the-amiga-1/" target="_blank" title="Share via Email"><i class="fas fa-envelope"></i> Email</a></span>
<span><a class="" href="https://www.reddit.com/submit?url=https%3A//www.thedigitalcatonline.com/blog/2018/05/28/exploring-the-amiga-1/&title=Exploring%20the%20Amiga%20-%20Part%201" target="_blank" title="Share via Reddit"><i class="fab fa-reddit"></i> Reddit</a></span></p>    
    </div>
  </header>
  
  <div class="post-content">
    <p>Recently I decided to give some time to retroprogramming, and in particular to explore the architecture of some famous microcomputer and consoles of the 80s and 90s. Glorious 8-bit systems like the ZX Spectrum, the Commodore 64, or the Nintendo Entertainment System. 16-bits giants the likes of the Amiga, its (eventually winning) MS-DOS-based counterparts running on the early x86 architectures, the immortal Nintendo Super Famicom and SEGA Genesis.</p><p>I am deeply convinced that learning architectures is a perfect way to become a better programmer, even now that we have 64-bits processors, fifth generation languages, and Internet. Those old systems had many limitations and to get interesting results the programmer has to know the hardware and exploit every single bit of power it can deliver.</p><p>This is sometimes not true any more nowadays. On the one hand this is good, as it allows us to concentrate on business decisions and on higher layer of abstraction. On the other hand it was and it will always be useful for a programmer to face a limited system and to try to get the maximum out of it.</p><p>This series of posts is about the Commodore Amiga. Thousands of words have already been written on the Amiga, and I will not add anything but &quot;milestone&quot; to the adjectives used to describe it. This post and the following ones are not intended to be a complete and well-organised review of the architecture. Instead, they will be more a set of &quot;lab notes&quot; for myself that I write while I explore the platform. I put them on the blog in the hope that they will be useful for other programmers that try to crack the same problems.</p><h2 id="assembly-language-and-the-amiga-5bc5">Assembly language and the Amiga<a class="headerlink" href="#assembly-language-and-the-amiga-5bc5" title="Permanent link">¶</a></h2><p>If you want to write Assembly programs for the Amiga you can either work directly on a real system or use a cross-compiler. I prefer to work on my Linux system because, as much as I like retro architectures, I also like the power of a good Unix system and a modern editor.</p><p>Cross-compiling is a very simple concept: instead of compiling source code and creating binaries for the architecture you are running the compiler on, you create binaries for a different architecture. In this case the host architecture is Linux/amd64 and the target architecture is Amiga.</p><p>As this is not the only project I am following at the moment, I created a directory to host everything I need for the Amiga development: compiler, documentation, scripts.</p><h3 id="install-vasm-159b">Install vasm</h3><p>On Linux you can both use the GCC compiler or install vasm. The latter uses the same syntax as the standard Amiga assemblers, especially for compiler directives like <code>macro</code> and <code>include</code>, thus making it easier to pick up and use code published in books and in magazines during the 80s.</p><p>To install the latest vasm you can run the following code</p><div class="code"><div class="content"><div class="highlight"><pre>wget -q &quot;http://sun.hasenbraten.de/vasm/release/vasm.tar.gz&quot;
tar xvf vasm.tar.gz # The file is not actually gzipped
rm vasm.tar.gz
cd vasm
make CPU=m68k SYNTAX=mot
cd ..
</pre></div> </div> </div><h3 id="install-a-disassembler-d73b">Install a disassembler</h3><p>The vbcc suite written by Volker Barthelmann contains a disassembler for the M68k architecture that you can find <a href="http://sun.hasenbraten.de/~frank/projects/">here</a>.</p><p>A disassembler is a handy tool that can reveal a lot about how a program works. You can install it with the following code</p><div class="code"><div class="content"><div class="highlight"><pre>wget -q &quot;http://sun.hasenbraten.de/~frank/projects/download/vdam68k.tar.gz&quot;
tar xvzf vdam68k.tar.gz 
cd vda/M68k/
make
</pre></div> </div> </div><p>which will create the executable <code>vda/M68k/vda68k</code> that you can use to disassemble Amiga programs or ROM dumps.</p><h3 id="install-the-ndk-2146">Install the NDK</h3><p>The Native Development Kit (the Amiga SDK) contains include files that can be very helpful (though not strictly necessary) when developing. Unfortunately the NDK is still copyrighted by some of the guys that are trying to resurrect the Amiga. The latter idea is nice, but I really do not understand how preventing distribution of development documentation about a platform dead more than 20 years ago might help such a project.</p><p>Whatever, you can get an old version of the Amiga Developer CD <a href="https://archive.org/details/amiga-developer-cd-v1_1">here</a>. This contains the NDK version 3.1 which is enough for what we are going to learn in this series.</p><p>You may want to rename the <code>Includes&Libs</code> directory to <code>Includes_Libs</code> to simplify its access by the compiler command line (<code>&</code> is a special character in bash).</p><h3 id="helper-script-and-test-2ce9">Helper script and test</h3><p>I created a <code>asm.sh</code> helper script to simplify the development process</p><div class="code"><div class="content"><div class="highlight"><pre><span class="ch">#!/bin/bash</span>

<span class="nv">BASE</span><span class="o">=</span><span class="s2">&quot;/where/you/put/everything&quot;</span>

<span class="si">${</span><span class="nv">BASE</span><span class="si">}</span>/vasm/vasmm68k_mot<span class="w"> </span>-kick1hunks<span class="w"> </span>-Fhunkexe<span class="w"> </span>-I<span class="si">${</span><span class="nv">BASE</span><span class="si">}</span>/NDK_3.1/Include_Libs/include_i<span class="w"> </span>-o<span class="w"> </span><span class="si">${</span><span class="nv">1</span><span class="p">/.asm/</span><span class="si">}</span><span class="w"> </span>-nosym<span class="w"> </span><span class="nv">$1</span>
</pre></div> </div> </div><p>Don&#x27;t forget to run <code>chmod 775 asm.sh</code> to make the script executable. Now run the following command</p><div class="code"><div class="content"><div class="highlight"><pre><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;loop:\n btst #6,\$bfe001\n bne loop\n rts\n&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test.asm<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>./asm.sh<span class="w"> </span>test.asm
</pre></div> </div> </div><p>This compiles a very small program that loops until you press the right mouse button. If everything has been correctly installed you should get the following output</p><div class="code"><div class="content"><div class="highlight"><pre>vasm 1.8c (c) in 2002-2018 Volker Barthelmann
vasm M68k/CPU32/ColdFire cpu backend 2.3b (c) 2002-2017 Frank Wille
vasm motorola syntax module 3.11c (c) 2002-2018 Frank Wille
vasm hunk format output module 2.9b (c) 2002-2017 Frank Wille

CODE(acrx2):              12 bytes
</pre></div> </div> </div><p>And running the <code>file</code> command should return the correct type</p><div class="code"><div class="content"><div class="highlight"><pre>$ file test
test: AmigaOS loadseg()ble executable/binary
</pre></div> </div> </div><h2 id="lea-the-pc-and-the-relative-offset-b4f8">LEA, the PC and the relative offset<a class="headerlink" href="#lea-the-pc-and-the-relative-offset-b4f8" title="Permanent link">¶</a></h2><p>In Assembly, you can manage memory cells using either their content or the address, as you can do with pointers in C or similar concepts in other high-level languages. You can also set labels that the assembler will convert into instruction addresses, but these are (almost) always relative to the beginning of the code itself, as the code may be loaded anywhere in memory.</p><p>This means that, generally speaking, all the addresses we use when we branch to other parts of the code should be relative to the current instruction.</p><p>The Motorola 68k calls this addressing mode <em>Program Counter Indirect with Displacement Mode</em>. Its description contained in the Programmer&#x27;s Reference Manual is</p><div class="callout"><div class="content"><p>In this mode, the operand is in memory. The address of the operand is the sum of the address in the program counter (PC) and the sign-extended 16-bit displacement integer in the extension word. The value in the PC is the address of the extension word.</p>
<p>(2.2.11, page 2-13)</p></div></div><p>The usual assembler syntax for this addressing mode is <code>(d16,PC)</code> or <code>d16(PC)</code>, where <code>d16</code> is a 16-bits displacement. The <code>lea</code> instruction, for example, supports this mode, so we can find code like</p><div class="code"><div class="content"><div class="highlight"><pre>00000364: 41fa ffa6         lea     0x30c(pc),a0
</pre></div> </div> </div><p>Here the instruction is stored at address <code>0x0364</code> and it loads in the <code>a0</code> register the <em>effective address</em> of the instruction at <code>0x030c</code>.</p><p>Pay attention: since your code starts always at address <code>0x0</code>, you might be tempted to store the value <code>0x030c</code> into <code>a0</code> and go on. You want however to load the address that instruction has at runtime, which will be different from the current one. The displacement, however, will be the same, as the code doesn&#x27;t change its form, and this is why this addressing mode is useful.</p><h3 id="relative-offset-encoding-455d">Relative offset encoding</h3><p>A question may arise, then: why does the code show the address <code>0x30c</code>, which is the effective address, if the displacement is relative?</p><p>In the example, the syntax <code>0x30c(pc)</code> doesn&#x27;t mean &quot;the line at <code>0x30c</code> from the current line&quot;, but &quot;the line at <code>0x30c</code> <strong>considering that</strong> the current line is <code>0x0364</code>&quot;. Let&#x27;s dig into the binary representation of the instruction to see how the processor receives it. The value <code>0x41faffa6</code> in binary form is </p><div class="code"><div class="content"><div class="highlight"><pre>01000001111110101111111110100110
</pre></div> </div> </div><p>If we split it according to the Motorola 68k opcodes scheme (Programmer&#x27;s Reference Manual, Section 8) we get</p><div class="code"><div class="content"><div class="highlight"><pre>0100 000 111 111010 1111111110100110
^    ^       ^
lea  a0      (d16,PC)
</pre></div> </div> </div><p>So we know this is a <code>lea</code> to <code>a0</code> using Program Counter with Displacement. The address argument is <code>1111111110100110</code>, which has to be interpreted as a &quot;sign-extended 16-bit displacement integer&quot; as the Reference Manual stated. The value is the two&#x27;s complement representation of the decimal <code>-90</code>, and since the PC is pointing at the address itself (<code>0x0366</code>) the resulting address is <code>0x0366 - 90</code>, which gives <code>0x030c</code>.</p><p>The fact that the PC is pointing at the address might be overlooked. The manual says</p><div class="callout"><div class="content"><p>The value in the PC is the address of the extension word. (2.2.11, page 2-13)</p></div></div><p>So, while the Assembly code uses the absolute value, the actual opcode contains a true displacement from the current position. The disassembler formats the value so that it is easy for us to understand the effective address (<code>0x30c</code>), but also telling us that there is more going on behind the scenes using the <code>(pc)</code>suffix.</p><h2 id="how-to-open-a-library-c545">How to open a library<a class="headerlink" href="#how-to-open-a-library-c545" title="Permanent link">¶</a></h2><p>When you code in a high level language like C you usually refer to functions of an external library in your code and then provide the library object files on the compiler command line. The code of the library is either included in the code of your program or loaded into memory at runtime (shared libraries), but in both cases the function call is, at the machine language level, just a jump to a different address in memory.</p><p>If you write a program directly in Assembly language things are not different, you can always rely on the linker to properly address external libraries. In a platform like Amiga, however, it&#x27;s custom to access the system libraries in a direct way, manually jumping to the right address, which is why sometimes tutorials and books contain &quot;magic numbers&quot;.</p><p>When the Amiga OS loads a library in memory the Exec master library analyses its structure and creates the so-called <em>jump table</em>. This is nothing more than an array that lists the addresses of the functions exposed by the library. This is a very simple and effective way to let the OS free to load the library anywhere in memory (relocation).</p><p>The Exec master library is not different, but this library is loaded as part of the bootstrap process, and the base address is always stored in memory location <code>0x4</code>. To use one of Exec&#x27;s functions, then, we just need to issue a <code>jsr <address></code> (Jump to SubRoutine), where <code><address></code> is the current position in memory of the function we want to call. Since we don&#x27;t know the absolute address, being the library dynamically loaded, we use the library&#x27;s jump table to retrieve the base address and get the function address as a fixed offset from the former.</p><p>Many Amiga programmers knew (and know) the addresses by heart, which is fine since the Amiga OS promises not to change the order of the jump table among different versions of Exec. So, for example, the address of the <code>OpenLibrary</code> function can be found at <code>-552</code> bytes before the library base address, while <code>CloseLibrary</code> is at <code>-414</code>. To call the <code>OpenLibrary</code> function, then, you need the following code</p><div class="code"><div class="content"><div class="highlight"><pre>    move.l 4.w,a6   ; a6 = base address of Exec
    jsr -552(a6)    ; OpenLibrary()
</pre></div> </div> </div><p>The first instruction moves the value contained at address <code>0x4</code> into the <code>a6</code> register. This way the register will contain the base address of Exec. Then it jumps to the subroutine which address is 552 bytes before that base address. So, if <code>a6</code> contains an address like <code>0x20000</code> the code jumps to <code>0x1fdd8</code> (<code>0x20000 - 552</code>). This also shows us that the jump table is actually a proper list of jump instructionss, not just addressess.</p><p>The <code>OpenLibrary</code> function, however, expects some parameters, as you can see on the documentation page <code>exec.library/OpenLibrary</code> (<a href="http://amigadev.elowar.com/read/ADCD_2.1/Includes_and_Autodocs_3._guide/node0222.html">here</a>).</p><div class="code"><div class="content"><div class="highlight"><pre>library = OpenLibrary(libName, version)
D0                    A1       D0
</pre></div> </div> </div><p>The pointer to the library name has to be in the register <code>a1</code> and the minimum accepted version in <code>d0</code>. The code becomes</p><div class="code"><div class="content"><div class="highlight"><pre>    move.l 4.w,a6        ; a6 = base address of Exec
    clr.l d0             ; 0 = accept all versions
    move.l #libname,a1   ; a1 = address of the libname string
    jsr -552(a6)         ; OpenLibrary()

libname:
    dc.b &quot;somename.library&quot;,0
</pre></div> </div> </div><h2 id="whats-next-0c7e">What's next<a class="headerlink" href="#whats-next-0c7e" title="Permanent link">¶</a></h2><p>In the next article I will explore the library jump table in detail, discussing in particular the first four entries. I will also show how types and structures are defined in the Assembly include files.</p><h2 id="resources-edc5">Resources<a class="headerlink" href="#resources-edc5" title="Permanent link">¶</a></h2><ul><li>Motorola M68000 Family Programmer&#x27;s Reference Manual - <a href="https://www.nxp.com/docs/en/reference-manual/M68000PRM.pdf">https://www.nxp.com/docs/en/reference-manual/M68000PRM.pdf</a></li><li><a href="http://amigadev.elowar.com">AmigaOS Developer Docs</a></li></ul><h2 id="feedback-d845">Feedback<a class="headerlink" href="#feedback-d845" title="Permanent link">¶</a></h2><p>Feel free to reach me on <a href="https://twitter.com/thedigicat">Twitter</a> if you have questions. The <a href="https://github.com/TheDigitalCatOnline/blog_source/issues">GitHub issues</a> page is the best place to submit corrections.</p>
  </div>

  <section class="links">
    <header>
      <h2>Part 1 of the Exploring the Amiga series</h2>
    </header>
    <div>
      
      <h3>Next articles</h3>
      <ul>
        <li><a href="/blog/2018/05/28/exploring-the-amiga-2/">Exploring the Amiga - Part 2</a></li>
        <li><a href="/blog/2018/06/08/exploring-the-amiga-3/">Exploring the Amiga - Part 3</a></li>
        <li><a href="/blog/2018/06/14/exploring-the-amiga-4/">Exploring the Amiga - Part 4</a></li>
        <li><a href="/blog/2018/06/25/exploring-the-amiga-5/">Exploring the Amiga - Part 5</a></li>
        <li><a href="/blog/2018/06/25/exploring-the-amiga-6/">Exploring the Amiga - Part 6</a></li>
        <li><a href="/blog/2019/02/19/exploring-the-amiga-7/">Exploring the Amiga - Part 7</a></li>
        <li><a href="/blog/2019/02/19/exploring-the-amiga-8/">Exploring the Amiga - Part 8</a></li>
      </ul>
    </div>
  </section>

  <section>
    <header>
      <h2>Related Posts</h2>
    </header>
    <div class="paginated-posts">
      <div class="posts">
	<article class="card">
          <a href="/blog/2019/02/19/exploring-the-amiga-8/">
            <img src="/images/exploring-the-amiga-8.jpg" alt="exploring-the-amiga-8" />
          </a>
          <div class="body">
            <a href="/blog/2019/02/19/exploring-the-amiga-8/"><h2>Exploring the Amiga - Part 8</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/amiga/" class="tag">amiga</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2019-02-19T14:00:00+01:00">Feb 19, 2019</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-12-20T08:00:00+00:00">Dec 20, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2019/02/19/exploring-the-amiga-7/">
            <img src="/images/exploring-the-amiga-7.jpg" alt="exploring-the-amiga-7" />
          </a>
          <div class="body">
            <a href="/blog/2019/02/19/exploring-the-amiga-7/"><h2>Exploring the Amiga - Part 7</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/amiga/" class="tag">amiga</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2019-02-19T13:00:00+01:00">Feb 19, 2019</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-26T08:00:00+00:00">Feb 26, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2018/06/25/exploring-the-amiga-6/">
            <img src="/images/exploring-the-amiga-6.jpg" alt="exploring-the-amiga-6" />
          </a>
          <div class="body">
            <a href="/blog/2018/06/25/exploring-the-amiga-6/"><h2>Exploring the Amiga - Part 6</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/amiga/" class="tag">amiga</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2018-06-25T13:00:00+01:00">Jun 25, 2018</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-26T08:00:00+00:00">Feb 26, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2018/06/25/exploring-the-amiga-5/">
            <img src="/images/exploring-the-amiga-5.jpg" alt="exploring-the-amiga-5" />
          </a>
          <div class="body">
            <a href="/blog/2018/06/25/exploring-the-amiga-5/"><h2>Exploring the Amiga - Part 5</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/amiga/" class="tag">amiga</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2018-06-25T12:00:00+01:00">Jun 25, 2018</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-26T08:00:00+00:00">Feb 26, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2018/06/14/exploring-the-amiga-4/">
            <img src="/images/exploring-the-amiga-4.jpg" alt="exploring-the-amiga-4" />
          </a>
          <div class="body">
            <a href="/blog/2018/06/14/exploring-the-amiga-4/"><h2>Exploring the Amiga - Part 4</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/amiga/" class="tag">amiga</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2018-06-14T14:30:00+01:00">Jun 14, 2018</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-26T08:00:00+00:00">Feb 26, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2018/06/08/exploring-the-amiga-3/">
            <img src="/images/exploring-the-amiga-3.jpg" alt="exploring-the-amiga-3" />
          </a>
          <div class="body">
            <a href="/blog/2018/06/08/exploring-the-amiga-3/"><h2>Exploring the Amiga - Part 3</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/amiga/" class="tag">amiga</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2018-06-08T12:30:00+01:00">Jun 8, 2018</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-02-26T08:00:00+00:00">Feb 26, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2018/05/28/exploring-the-amiga-2/">
            <img src="/images/exploring-the-amiga-2.jpg" alt="exploring-the-amiga-2" />
          </a>
          <div class="body">
            <a href="/blog/2018/05/28/exploring-the-amiga-2/"><h2>Exploring the Amiga - Part 2</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/amiga/" class="tag">amiga</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2018-05-28T15:00:00+01:00">May 28, 2018</time></p>
	      <p><i class="fas fa-edit"></i> Updated on <time datetime="2021-12-21T08:00:00+00:00">Dec 21, 2021</time></p>
	    </div>
          </div>
	</article>
	<article class="card">
          <a href="/blog/2019/03/04/motorola-68000-addressing-modes/">
            <img src="/images/mc68000.jpg" alt="mc68000" />
          </a>
          <div class="body">
            <a href="/blog/2019/03/04/motorola-68000-addressing-modes/"><h2>Motorola 68000: addressing modes</h2></a>
	    <div class="info">
	      <p class="tags">
		<a href="/categories/assembly/" class="tag">assembly</a>
		<a href="/categories/m68000/" class="tag">M68000</a>
		<a href="/categories/retroprogramming/" class="tag">retroprogramming</a>
              </p>
	      <p><i class="fas fa-calendar-alt"></i> <time datetime="2019-03-04T22:30:00+01:00">Mar 4, 2019</time></p>
	    </div>
          </div>
	</article>
      </div>
    </div>
  </section>
  
</div>

      </div>
    </div>
    <script src="/theme/js/packed.js?46a8f903"></script>

<script src="/theme/js/retro.min.js?d41d8cd9"></script>
  </body>
</html>